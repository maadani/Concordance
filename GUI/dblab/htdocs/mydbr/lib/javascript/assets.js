(function(b){b.fn.parentRelative=function(){var a,e={},f;e.left=0;e.top=0;f=b(this);while(f.offsetParent()[0].tagName!=="BODY"&&f.offsetParent()[0].tagName!=="HTML"){a=f.offsetParent().position();e.left+=a.left;e.top+=a.top;f=f.offsetParent()}return e}}(jQuery));function makeEvent(f,h,i,j){function g(){return h(i)}if(f.addEventListener){f.addEventListener(j,g,false)}else{if(f.attachEvent){f.attachEvent("on"+j,g)}}}function appbar(b){if(b==0){window.location="logout.php"}else{if(b==1){document.forms.menubarform.app.value="passwd"}else{document.forms.menubarform.app.value="admin0"}document.forms.menubarform.submit()}}String.prototype.unescapeHtml=function(){var c,d;c=document.createElement("div");c.innerHTML=this;d=c.childNodes[0].nodeValue;c.removeChild(c.firstChild);return d};function getTableCell(d,f){var e=d.parentNode.parentNode.cells[f].innerHTML;if(e.length==0){return""}return e.unescapeHtml()}function datepicker(b){$(b).datepicker({showButtonPanel:true,altFormat:"yy-mm-dd"})}function search_table(n,p){var l=n.value.toLowerCase().split(" "),i,o,r,m,k,q;if(i===null){i=$(n).closest("table")}else{i=document.getElementById(p)}q=$(i).width();for(r=1;r<i.rows.length;r++){if(i.rows[r].cells[0].nodeName.toLowerCase()!="th"){o=$(i.rows[r]).find("td").clone().children(".drillmenuitems").remove().end().text();k="none";for(m=0;m<l.length;m++){if(o.toLowerCase().indexOf(l[m])>=0){k=""}else{k="none";break}}i.rows[r].style.display=k}}$(i).width(q);mydbr_table_changed($(i).attr("id"))}function htmlspecialchars_decode(g,i){var k=0,l=0,j=false,h;if(typeof i==="undefined"){i=2}g=g.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");h={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(i===0){j=true}if(typeof i!=="number"){i=[].concat(i);for(l=0;l<i.length;l++){if(h[i[l]]===0){j=true}else{if(h[i[l]]){k=k|h[i[l]]}}}i=k}if(i&h.ENT_HTML_QUOTE_SINGLE){g=g.replace(/&#0*39;/g,"'")}if(!j){g=g.replace(/&quot;/g,'"')}g=g.replace(/&amp;/g,"&");return g}function sprintf(){var m,l,r,q,a,o,p,n,i;m=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g;l=arguments;n=0;i=l[n++];r=function(f,d,e,b){if(!e){e=" "}var c=(f.length>=d)?"":Array(1+d-f.length>>>0).join(e);return b?f+c:c+f};q=function(b,d,f,c,e,g){var h=c-b.length;if(h>0){if(f||!e){b=r(b,c,g,f)}else{b=b.slice(0,d.length)+r("",h,"0",true)+b.slice(d.length)}}return b};a=function(g,h,j,f,e,d,b){var c=g>>>0;j=j&&c&&{"2":"0b","8":"0","16":"0x"}[h]||"";g=j+r(c.toString(h),d||0,"0",false);return q(g,j,f,e,b)};o=function(b,f,e,d,c,g){if(d!=null){b=b.slice(0,d)}return q(b,"",f,e,c,g)};p=function(b,I,H,k,C,e,J){var f,L,g,K,F,h,j=false,G="",D=false,c=false,d=" ",E;if(b=="%%"){return"%"}E=H.length;for(f=0;H&&f<E;f++){switch(H.charAt(f)){case" ":G=" ";break;case"+":G="+";break;case"-":j=true;break;case"'":d=H.charAt(f+1);break;case"0":D=true;break;case"#":c=true;break}}if(!k){k=0}else{if(k=="*"){k=+l[n++]}else{if(k.charAt(0)=="*"){k=+l[k.slice(1,-1)]}else{k=+k}}}if(k<0){k=-k;j=true}if(!isFinite(k)){throw new Error("sprintf: (minimum-)width must be finite")}if(!e){e="fFeE".indexOf(J)>-1?6:(J=="d")?0:undefined}else{if(e=="*"){e=+l[n++]}else{if(e.charAt(0)=="*"){e=+l[e.slice(1,-1)]}else{e=+e}}}h=I?l[I.slice(0,-1)]:l[n++];switch(J){case"s":return o(String(h),j,k,e,D,d);case"c":return o(String.fromCharCode(+h),j,k,e,D);case"b":return a(h,2,c,j,k,e,D);case"o":return a(h,8,c,j,k,e,D);case"x":return a(h,16,c,j,k,e,D);case"X":return a(h,16,c,j,k,e,D).toUpperCase();case"u":return a(h,10,c,j,k,e,D);case"i":case"d":L=parseInt(+h,10);g=L<0?"-":G;h=g+r(String(Math.abs(L)),e,"0",false);return q(h,g,j,k,D);case"e":case"E":case"f":case"F":case"g":case"G":L=+h;g=L<0?"-":G;K=["toExponential","toFixed","toPrecision"]["efg".indexOf(J.toLowerCase())];F=["toString","toUpperCase"]["eEfFgG".indexOf(J)%2];h=g+Math.abs(L)[K](e);return q(h,g,j,k,D)[F]();default:return b}};return i.replace(m,p)}function number_format(o,r,m,p){if(typeof o=="undefined"){return""}o=(o+"").replace(",","").replace(" ","");var s=!isFinite(+o)?0:+o,t=!isFinite(+r)?0:Math.abs(r),k=(typeof p==="undefined")?",":p,q=(typeof m==="undefined")?".":m,l="",n=function(c,a){var b=Math.pow(10,a);return""+Math.round(c*b)/b};l=(t?n(s,t):""+Math.round(s)).split(".");if(l[0].length>3){l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,k)}if((l[1]||"").length<t){l[1]=l[1]||"";l[1]+=new Array(t-l[1].length+1).join("0")}return l.join(q)}function parse_num_attr(href){var src=href.substr(href.indexOf("?")+1),attr,attrs=src.split("&"),str="{",i;for(i=0;i<attrs.length;i++){attr=attrs[i].split("=");if(i>0){str+=","}str+=attr[0]+":"+attr[1]}str+="}";return eval("("+str+")")}function is_touch_device(){return Modernizr.touch}function init_scale_image(f){var d,e;d=(f)?f:"";$(d+" div.scale_image").each(function(a){var b,c;if($(this).css("position")!="absolute"){$(this).css("left",$(this).position().left+"px");$(this).css("position","absolute");$(this).css("top",($(this).position().top-25)+"px");b=$($(this).next()[0].useMap).first().children();for(c=0;c<b.length;c++){$.data(b[c],"coords",b[c].coords)}}$(this).slider({value:100,min:10,max:100,slide:function(r,q){var o,s=$(this).next()[0],n,p,t=q.value/100;if(s.style.height!="auto"){$.data(this,"width",$(s).width());$.data(this,"left",$(s).position().left)}o=$.data(this,"width");n=0;p=1;t=n+(t*(p-n));s.style.width=(t*o)+"px";s.style.height="auto";$(s).position().left=$.data(this,"left")},change:function(p,v){var u,i,t,r,q,s=$($(this).next()[0].useMap).first().children();for(r=0;r<s.length;r++){i="";t=$.data(s[r],"coords").split(" ");for(q=0;q<t.length;q++){e=t[q].split(",");for(u=0;u<e.length;u++){e[u]=Math.round(e[u]*v.value/100);i+=e[u];if(u+1!=e.length){i+=","}}if(q+1!=t.length){i+=" "}}s[r].coords=i}}})})}$.fn.serializeObject=function(){var d={},a=this.serializeArray();$.each(a,function(){if(d[this.name]){if(!d[this.name].push){d[this.name]=[d[this.name]]}d[this.name].push(this.value||"")}else{d[this.name]=this.value||""}});return d};function getUrlVars(){var e,g=[],h,f=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(e=0;e<f.length;e++){h=f[e].split("=");g.push(h[0]);g[h[0]]=h[1]}return g}function getURLParameter(b){return decodeURI((RegExp(b+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function getUrlPath(){var b=window.location;return b.protocol+"//"+b.host+b.pathname}function array_identical(b,f){var a=b.length;if(a!=f.length){return false}while(a--){if(b[a]!==f[a]){return false}}return true}(function(d){var a=d(window);d.fn.viewportOffset=function(){var b=d(this).offset();return{left:b.left-a.scrollLeft(),top:b.top-a.scrollTop()}}})(jQuery);function resize_codemirror(f,d){var e;if(typeof d==="undefined"){d=120}if(!editor.space_below){editor.space_below=d}e=$(window).height()-$(".CodeMirror").offset().top-editor.space_below;editor.setSize("100%",e+"px")}function unicodeToChar(b){return b.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(a){return String.fromCharCode(parseInt(a.replace(/\\u/g,""),16))})}jQuery.uaMatch=function(c){c=c.toLowerCase();var d=(/(chrome)[ \/]([\w.]+)/.exec(c))||(/(webkit)[ \/]([\w.]+)/.exec(c))||(/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(c))||(/(msie) ([\w.]+)/.exec(c))||c.indexOf("compatible")<0&&(/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(c))||[];return{browser:d[1]||"",version:d[2]||"0"}};if(!jQuery.browser){matched=jQuery.uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else{if(browser.webkit){browser.safari=true}}jQuery.browser=browser}function Countdown(j){var r,l=this,o=j.seconds||10,m=j.onUpdateStatus||function(){},n=j.onCounterEnd||function(){},k=j.display_obj||"refresh_counter",q="go";function p(){if(q=="go"){o--;m(o);if(o<=0){l.stop();n()}}}this.start=function(){clearInterval(r);r=0;r=setInterval(p,1000)};this.stop=function(){clearInterval(r)};this.toggle=function(){$("."+k).toggleClass("paused");if(q=="go"){q="pause"}else{o=parseInt($("."+k).text(),10);q="go"}}}function isIE(){return(navigator.userAgent.indexOf("MSIE")!==-1||navigator.appVersion.indexOf("Trident/")>0)}function csrf_token_get(){return $("#csrf_token").val()}function mydbr_table_changed(b){if($("#"+b).hasClass("lockcolumns")){$("#"+b).lockcolumns()}}function gup(f,h){var g,i,j;h=h.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");g="[\\?&]"+h+"=([^&#]*)";i=new RegExp(g);j=i.exec(f);if(j==null){return""}else{return j[1]}}jQuery.extend({getQueryParameters:function(b){return(b||document.location.search).replace(/(^\?)/,"").split("&").map(function(a){return a=a.split("="),this[a[0]]=a[1],this}.bind({}))[0]}});var Cell_data={get_moment_format:function(c){var d;d=mydbr_sorting.dateformat;if(c=="date"){d=mydbr_sorting.dateformat.substring(0,mydbr_sorting.dateformat.indexOf(" "))}if(c=="time"){d=mydbr_sorting.dateformat.substring(mydbr_sorting.dateformat.indexOf(" ")+1)}return d.replace("m","MM").replace("d","DD").replace("d","DD").replace("Y","YYYY").replace("i","mm").replace("s","ss")},get_formatted:function(h,i){switch(i){case"date":case"datetime":if(typeof h=="number"){return moment(h).format(Cell_data.get_moment_format(i))}break;case"time":if(typeof h=="number"){var j,g,f=Math.floor(h/3600);h-=f*3600;g=Math.floor(h/60);h-=g*60;g="0"+g;g=g.substr(-2);h="0"+h;h=h.substr(-2);return f+":"+g+((h!=="00")?":"+h:"")}}return h},get_value_raw:function(h,r){var m,s,n,q;switch(r){case"int":case"float":case"bit":if(typeof h=="number"||typeof h=="undefined"){return h}s=1;m=h.replace(/[^\(0-9\.,\-\)]/g,"");if(m.substring(0,1)=="("&&m.substr(-1)==")"){m=m.substring(1);m=m.substring(0,m.length-1);s=-1}m=m.replace(mydbr_sorting.separator.thousand,"");m=m.replace(mydbr_sorting.separator.decimal,".");if(r=="float"){return parseFloat(m)*s}return parseInt(m,10)*s;break;case"date":case"datetime":n=mydbr_sorting.dateformat.replace("m","MM").replace("d","DD").replace("d","DD").replace("Y","YYYY").replace("i","mm").replace("s","ss");h=moment(h,n).format("YYYY-MM-DDTh:mm:ss");q=parseFloat(new Date(h).getTime());return(isNaN(q))?0:q;break;case"time":var p,t,o,i=h.split(":");p=typeof i[0]=="undefined"?0:parseInt(i[0],10);t=typeof i[1]=="undefined"?0:parseInt(i[1],10);o=typeof i[2]=="undefined"?0:parseInt(i[2],10);p=typeof p=="undefined"||isNaN(p)?0:p;t=typeof t=="undefined"||isNaN(t)?0:t;o=typeof o=="undefined"||isNaN(o)?0:o;return o+t*60+p*3600;break;case"char":return h;break;default:}return h}};$(document).ready(function(){$(document).on("click",".param_input .checkboxitem",function(){set_param_cb_value(this)});$(document).on("click",".param_input .optgroupcb",function(){select_opt_group(this)});$(document).on("change",".param_daterange",function(){user_date_range(this)});init_report_params("")});function is_IE8(){return $.browser.msie&&+$.browser.version===8}function user_date_range(q){var p,l,k,o=$(q).prevAll("input"),j=mydbr_sorting.dateformat.replace("d","DD").replace("m","MM").replace("Y","YYYY").substr(0,10),m=mydbr_sorting.dateformat.replace("d","DD").replace("m","MM").replace("Y","YYYY").replace("i","mm").replace("s","ss"),r,n;if(q.value=="none"){return}if(o.length>1){k=$(o[1]);l=$(o[0]);r=k.hasClass("datetimepick")?m:j;n=l.hasClass("datetimepick")?m:j}if(o.length==1){k=$(o[0]);r=k.hasClass("datetimepick")?m:j}if(is_touch_device()){r=k.hasClass("datetimepick")?"YYYY-MM-DDTHH:mm:ss":"YYYY-MM-DD";if(typeof(l)!=="undefined"){n=l.hasClass("datetimepick")?"YYYY-MM-DDTHH:mm:ss":"YYYY-MM-DD"}}p=JSON.parse(q.value);if(p.from.type=="day"){k.val(moment().add(p.from.value,"day").startOf("day").format(r));if(typeof(l)!=="undefined"){l.val(moment().add(p.to.value,"day").endOf("day").format(n))}}if(p.from.type=="month"||p.from.type=="year"){if(p.to.value==null){k.val(moment().startOf(p.from.type).startOf("day").format(r));if(typeof(l)!=="undefined"){l.val(moment().endOf(p.to.type).format(n))}}else{if(p.from.value<0&&p.to.value<0){k.val(moment().startOf(p.from.type).add(p.from.value,p.from.type).format(r));if(typeof(l)!=="undefined"){l.val(moment().add(p.to.value,p.from.type).endOf(p.from.type).format(n))}}else{k.val(moment().add(p.from.value,p.from.type).startOf("day").add(1,"day").format(r));if(typeof(l)!=="undefined"){l.val(moment().add(p.to.value,p.to.type).endOf("day").format(n))}}}}if(p.from.type=="quarter"){if(p.to.value==null){k.val(moment().startOf("quarter").format(r));if(typeof(l)!=="undefined"){l.val(moment().endOf("quarter").format(n))}}else{k.val(moment().startOf("quarter").add(p.from.value,"quarter").format(r));if(typeof(l)!=="undefined"){l.val(moment().add(p.to.value,"quarter").endOf("quarter").format(n))}}}}function init_report_params(b){$(b+" .init_scb").scrollcheckbox();if(!is_touch_device()&&!is_IE8()){if(!window.Modernizr.inputtypes.date){$(b+" .param_input .datetimefilter").each(function(){var a;if($(this).attr("data-format_am")=="ampm"){a=["am","pm"]}else{a=["AM","PM"]}$(this).datetimeEntry({datetimeFormat:$(this).attr("data-format"),spinnerImage:"",ampmNames:a})})}}set_optgroup_state(b);$(b+" .autosize_animate").autosize({append:"\n"});if((!window.Modernizr.inputtypes.date||!is_touch_device())){$(b+" .datepick").each(function(){if(!is_IE8()){$(this).attr("type","text")}var a={showOtherMonths:true,selectOtherMonths:true,showButtonPanel:true,changeMonth:true,changeYear:true,showOn:"button",buttonImage:"lib/external/jquery/css/images/calendar.png",buttonImageOnly:true,dateFormat:$(this).attr("data-dateformat")};if($(this).attr("data-years")){a.yearRange=$(this).attr("data-years")}$(this).datepicker(a)})}else{$(b+" .datepick").each(function(){$(this).val($(this).attr("data-stddatetime"))})}if(!window.Modernizr.inputtypes["datetime-local"]||!is_touch_device()){$(b+" .datetimepick").each(function(){if(!is_IE8()){$(this).attr("type","text")}var a={showOtherMonths:true,selectOtherMonths:true,showButtonPanel:true,changeMonth:true,changeYear:true,showOn:"button",buttonImage:"lib/external/jquery/css/images/calendar.png",buttonImageOnly:true,dateFormat:$(this).attr("data-dateformat"),timeFormat:$(this).attr("data-timeformat"),showHour:true,showMinute:true,showSecond:true,addSliderAccess:true,sliderAccessArgs:{touchonly:false}};if($(this).attr("data-years")){a.yearRange=$(this).attr("data-years")}$(this).datetimepicker(a)})}else{$(b+" .datetimepick").each(function(){$(this).val($(this).attr("data-stddatetime"))})}if(!window.Modernizr.inputtypes.time||!is_touch_device()){$(b+" .timepick").each(function(){if(!is_IE8()){$(this).attr("type","text")}$(this).timepicker({buttonImage:"lib/external/jquery/css/images/calendar.png",timeFormat:$(this).attr("data-timeformat"),addSliderAccess:true,sliderAccessArgs:{touchonly:false}})})}else{$(b+" .timepick").each(function(){$(this).val($(this).attr("data-stddatetime"))})}$(b+" .select2").each(function(){var d,a=$(this).outerWidth()+10+"px";if(parseInt(a,10)<20){d={dropdownAutoWidth:true}}else{d={width:a}}$(this).select2(d)});if($(b+" .report_autoexecute").length>0){$(".runreport").click()}$(b+" .ac_input").on("focusout",function(){if($(this).val()==""){var d,a=$(this).closest(".param_row").nextAll(".param_row");for(d=0;d<a.length;d++){if(!$(a[d]).hasClass("ac_id")){break}$(a[d]).find("input").val("")}}})}function select_opt_group(i){var j=$(i).parents(".optgroup"),g=j.find(".checkboxitem:visible").length,e=j.find(".checkboxitem:checked:visible").length,h;h=g>e&&$(i).is(":checked")?true:false;j.find(".checkboxitem:visible").prop("checked",h);set_param_cb_value(j.find(".checkboxitem")[0]);j.parents(".checkboxlist").find(".optgroupclick").click();j.find(".checkboxitem").first().trigger("change")}function set_optgroup_state(g,h){if(typeof(h)=="undefined"){$(g+" .param_input").find(".optgroup").each(function(){set_optgroup_state(g,$(this))})}if($(h).hasClass("checkboxlist")){h.find(".optgroup").each(function(){set_optgroup_state("",$(this))})}if($(h).hasClass("optgroup")){var f=h.find(".checkboxitem").filter(function(){return $(this).parent().css("display")!=="none"}).length,e=h.find(".checkboxitem:checked").filter(function(){return $(this).parent().css("display")!=="none"}).length;h.find(".optgroupcb").prop("indeterminate",false);if(f==e&&f!=0){h.find(".optgroupcb").prop("checked",true)}else{if(e==0){h.find(".optgroupcb").prop("checked",false)}else{h.find(".optgroupcb").prop("checked",false);h.find(".optgroupcb").prop("indeterminate",true)}}}}function set_param_cb_value(d){var f="",e="";$(d).parents(".checkboxlist").find(".checkboxitem:checked").each(function(){f+=e+$(this).val();e=","});$(d).parents(".checkboxlist").find(".cbinput").val(f);set_optgroup_state("",$(d).parents(".optgroup"))}function set_param_autocomplete(f,d,e){$("#"+f).autocomplete("apps/paramautoc.php",{extraParams:{sql:d,id:f},highlight:false,matchContains:true,max:e,scrollHeight:360,cacheLength:0,formatItem:function(a){return a[0]+(a[1]==undefined?"":a[1])},selectedRow:function(a){var c,h,b;for(h=2;h<a.length;h++){b=f.match(/\d+$/);c=f.substring(0,f.length-b.toString().length)+(parseInt(b,10)+h-1);$("#"+c).val(htmlspecialchars_decode(a[h]))}},formatResult:function(a){return htmlspecialchars_decode(a[0])}})}function input_change_handler(b){if(b.attr("data-last_value")==undefined){b.attr("data-last_value",b.val())}else{if(b.attr("data-last_value")!=b.val()){b.attr("data-last_value",b.val());b.trigger("change")}}}function init_connected_param(elem,param,affected,datatypes,params){var $te,input,data,cv,tobechanged;if(elem){elem="#"+elem+" "}if(1==0){$te=$(elem+'input[name="u'+param+'"]');if($te.closest(".checkboxlist").length>0){setInterval(function(){input_change_handler($te)},100)}}$(document).on("change",elem+"input.checkboxitem, "+elem+'input[name="u'+param+'"], '+elem+'select[name="u'+param+'"]',function(e){var i,tc,id_check;if($(this).hasClass("checkboxitem")){id_check=elem+"u"+param;if(this.id.substr(0,id_check.length)!=id_check){return}set_param_cb_value(this)}else{cv=$(this).attr("data-cv");if($(this).attr("type")!="radio"&&typeof cv!=="undefined"&&cv!==false){if(cv==$(this).val()){return}}}tobechanged=[];for(i=0;i<affected.length;i+=2){data=$(elem+"form").first().serializeObject();data.p_elem=elem;data.p_id=affected[i];data.p_query=affected[i+1];data.p_datatypes=datatypes;data.p_params=params;data.p_options="{}";input=$(elem+'[name="u'+data.p_id+'"]').first();if(input.first().is("select")||input.parent().hasClass("popuplist")){data.p_format="popup";if(input.hasClass("select2")){data.p_options='{"find":1}'}}else{if(input.parents().hasClass("checkboxlist")||input.first().next().find("input").attr("type")=="checkbox"){data.p_format="checkbox"}else{if(input.parent().hasClass("inline_param")){data.p_options='{"side_by_side":1}'}data.p_format="radio"}}tobechanged.push(elem+'[name="u'+affected[i]+'"]');$.ajax({url:"lib/connected_param.php",type:"get",data:data,async:false,success:function(data){eval(data)}})}$(this).attr("data-cv",$(this).val());for(tc=0;tc<tobechanged.length;tc++){$(tobechanged[tc]).first().change()}})}var hover_menu=null,mydbr_selected_cell=null,refreshCounter=null;$(document).ready(function(){if(is_touch_device()){$(".mydbr_popupframe").each(function(b){$(this).css("position","absolute")})}$(".mydbr_popupframe").each(function(b){$(this).draggable({handle:"th.border",stop:function(){popup_check_position("",$(this))}})});$(document).on("click",".search_arrow",function(){Tools(this)});$(document).on("click",".refresh_counter",function(){if(refreshCounter!==undefined&&!$(this).hasClass("no_toggle")){refreshCounter.toggle()}});$(document).on("click",".mydbr_popupframe th.border a.close, .dialog_close",function(){popupclose(this)});$(document).on("click",".mydbr_popupframe th.border a.newwin",function(){var b=$(this).closest(".mydbr_popupframe").attr("data-refreshurl");if(typeof b=="string"&&b!=""){window.open(b.replace("&hdr=0",""))}});$(document).on("click",".mydbr_popupframe th.border a.refresh",function(){popup_refresh(this)});$(document).on("keyup",".mydbr_popupframe",function(b){if(b.keyCode&&b.keyCode===$.ui.keyCode.ESCAPE){popupclose($(this).find("th.border a"))}});$(document).on("touchend",".mydbr_popupframe",function(){move_popup_to_top($(this))});$(document).on("click",".mydbr_popupframe",function(){move_popup_to_top($(this))});$(document).on("click",".popupmenu .popuprow",function(){changeObjectVisibility(window.currentlyVisiblePopup,"none");window.currentlyVisiblePopup=false});$(document).on("click","area.new_window,a.new_window",function(){window.open(this.href);return false});$(document).on("change","td.autosubmit .jeditableform select",function(){$(this).closest("form").submit()});init_report_elements("");if($("#ajaxBusy").length==0){$("body").append('<div id="ajaxBusy"><p><img src="interface/images/loader.gif"></p></div>')}$(document).ajaxStart(function(){$("#ajaxBusy").show()}).ajaxStop(function(){$("#ajaxBusy").hide()});$("#param_input_toggle").click(function(){$(".param_input").first().slideToggle()});$("importform").submit(function(){import_start(this)});$(document).on("click",".inline_close",function(b){$(this).closest("tr.inline_report").remove()});$(document).on("click",".inline_newwin",function(b){window.open($(this).attr("data-url"));$(this).closest("tr.inline_report").remove()})});function popup_refresh(j){var f,i,g,h;if(typeof j=="object"){f=$(j).closest(".mydbr_popupframe")}else{if(typeof j=="string"&&arguments.length==2){f=$(this).closest(".mydbr_popupframe")}else{if(typeof j=="string"&&arguments.length==1){f=$("#"+j).closest(".mydbr_popupframe")}}}if(f.length==1){h=f.attr("data-object");g=f.attr("data-refreshurl");i=f.find("th.border span").text();if(typeof h=="string"&&typeof g=="string"&&h!=""&&g!=""){embed_element(h,g,i)}}}function refresh_counter_init(b){refreshCounter=new Countdown({seconds:b,onCounterEnd:function(){location.reload()},onUpdateStatus:function(a){$(".refresh_counter").text(a)}});refreshCounter.start()}function ismainw(){return $("div.reports div.group").length?1:0}function fav_handle(reportid,url,favid,ismain){var curr_url="report.php"+location.search;if(ismain!==undefined&&ismain){curr_url=""}$.ajax({url:"apps_v/favourite_v.php",type:"post",data:{favid:favid,reportid:reportid,url:url,curr_url:curr_url},success:function(set){if(set){var fav_reports,ret=eval("("+set+")");$("#favmenu").html(ret.menu);hovermenu_init("",ismainw());fav_reports=new Array();$(".is_fav").each(function(s){if(jQuery.inArray(parseInt($(this).attr("id").substr(1),10),fav_reports)<0){$(this).toggleClass("no_fav");$(this).toggleClass("is_fav")}})}}})}function dynamic_pdf_export_url(e){var f,d;if($(".mydbr_tabs").length){f=$(e).find("li.pdf a").attr("href");d=$.getQueryParameters(f);$(".mydbr_tabs").each(function(b){var a=$(this).attr("id");d["t_"+a]=$("#"+a).tabs("option","active")});f=decodeURIComponent($.param(d,true));$(e).find("li.pdf a").attr("href",f)}}function hovermenu_init(c,d){$(c+" .hovermenu_icon > li").hover(function(){if(hover_menu){hover_menu.find("ul").fadeOut("fast");hover_menu.find(".menutip").css("display","none");hover_menu=null}$(this).find("ul").fadeIn("fast");dynamic_pdf_export_url($(this).find("ul"));$(this).find(".menutip").fadeIn("fast")},function(){hover_menu=$(this);setTimeout("check_hovermenu_hover()",400)});$(".favourites .rmfav").each(function(){$(this).click(function(){var a=parse_num_attr($(this).children(":first-child").attr("href"));fav_handle(a.r,"",a.f,ismainw());return false})});$(".favadd span a").click(function(){fav_handle($(this).parent().attr("id").substring(8),"report.php"+location.search,0);return false})}function check_hovermenu_hover(){if(hover_menu){hover_menu.find("ul").fadeOut("fast");hover_menu.find(".menutip").fadeOut("fast")}}function editable_def_callback(value,settings){var cut=0,is_json=false;if(value.substr(0,9)=="dbr.html:"){cut=9}else{if(value.substr(0,9)=="dbr.json:"){cut=9;is_json=true}else{if(value.substr(0,13)=="dbr.purehtml:"){cut=13}}}if(cut>0){if(is_json){json=jQuery.parseJSON(value.substr(cut));eval(json[0]);$(this).text(json[1])}else{$(this).html(value.substr(cut))}}}function init_report_elements(e){$(e+" div.pager").mydbr_pager();if((!$.browser.msie)||($.browser.version>=8)){$(e+" .tTip").tipTip({defaultPosition:"top",maxWidth:"auto"})}if($(e+" .search").length>0){if($(e+" .search").css("display")=="none"){$(e+" table").hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")})}}if(typeof mydbr_loc=="undefined"){return}$(e+" table th.selectfilter,"+e+" table th.textfilter").closest("table").each(function(){$(this).columnfilter({all:mydbr_loc.MYDBR_AA_ALL,skip_row:["summary_row"]})});$(e+" div.gvchart").hover(function(){$(this).addClass("gvchartactive")},function(){$(this).removeClass("gvchartactive")});$(e+" table.tblr:not(.no_tooltip) td").hover(function(s){tt(this)});$(e+" table.scrollable").each(function(){$(this).scrollabletable({height:$(this).attr("data-scrollheight")})});$(e+" table.sortable").each(function(){var i,sort_values,ts,sort_param=new Array(),w=["zebra"];ts=$(this).attr("data-sort");if(ts!==undefined){sort_values=ts.split(",");for(i=0;i<sort_values.length;i+=2){sort_param.push([sort_values[i],sort_values[i+1]])}}if($(this).hasClass("sort_rmbr")){w.push("saveSort")}$(this).tablesorter({widgets:w,sortList:sort_param})});$(e+" table.sortable th.cell_header,"+e+" table.sortable .cell_ct").each(function(s){if(!$(this).hasClass("unsortable")){this.title=mydbr_loc.MYDBR_AA_MULTILEVEL_SORT}});$(e+" table.lockcolumns").each(function(){$(this).lockcolumns()});if(!$.browser.msie||$.browser.version>=8){$(e+" table.stickyheader").each(function(){if($(this).closest(".mydbr_popupframe").length==0){$(this).stickyTableHeaders()}})}hovermenu_init(e,(location.pathname.slice(-9)=="index.php"));$(e+" .editable").each(function(i,e){var sql,type,url,options,editable_options,hash,inputtype,select,submit_b,cancel_b,no_edit,dataType,format,json_callback;sql=$(this).attr("data-url");no_edit=$(this).hasClass("no_edit");if(no_edit){$(this).removeClass("editable")}if(sql&&!no_edit){json_callback=0;format=$(this).attr("data-format");if(typeof format==typeof undefined||format==false){format=""}hash=$(this).attr("data-urlhash");type=$(this).attr("data-type");select=$(this).attr("data-select");selectquery=$(this).attr("data-selectquery");inputtype=$(this).attr("data-input");options=eval("("+$(this).attr("data-options")+")");dataType=(options.dataType==undefined)?"text":options.dataType;delete options.dataType;if(options.callback==undefined){options.callback=editable_def_callback;json_callback=1}options.callback_user=null;if(options.onblur==undefined){options.onblur="submit"}if((select!==undefined&&select!="")||(selectquery!=undefined&&selectquery!="")){if(select!==undefined&&select!=""){options.data=select}else{options.loadurl="lib/editable.php?"+selectquery}if(options.type==undefined){options.type=((inputtype==undefined)||inputtype=="")?"select":inputtype}options.callback_user=options.callback;options.callback=editable_select;json_callback=0}if(options.onblur!="submit"||options.type=="radiobutton"||options.type=="datetimepicker"||options.type=="datepicker"||options.type=="timepicker"){submit_b='<button type="submit">'+mydbr_loc.MYDBR_AA_OK+"</button>";cancel_b=mydbr_loc.MYDBR_AA_CANCEL;options.onblur=""}if(options.onblur!="submit"&&(options.type=="datepicker")){options.onblur=""}if(options.type==undefined&&$(this).hasClass("align_r")){options.type="textright"}if(!is_touch_device()&&options.type=="select"&&options.onblur=="submit"){$(this).addClass("autosubmit")}editable_options={submitdata:{mydbr_sql:sql,mydbr_type:type,mydbr_hash:hash,mydbr_format:format,mydbr_json_callback:json_callback},ajaxoptions:{dataType:dataType},placeholder:"",cssclass:"jeditableform",cancel:cancel_b,submit:submit_b};jQuery.extend(editable_options,options);url="lib/save.php";$(this).editable(url,editable_options);$(this).removeAttr("data-url");$(this).removeAttr("data-type");$(this).removeAttr("data-options");$(this).removeAttr("data-urlhash");$(this).removeAttr("data-select");$(this).removeAttr("data-query");$(this).removeAttr("data-input");$(this).removeAttr("data-colstyle")}});$(e+" div.dbrlist_menu").click(function(){$(this).children("ul").slideToggle("fast")});$(e+" .dbrlist li").each(function(s){$(this).click(function(){$(this).parent().children().removeClass("selected");$(this).addClass("selected")})});$(e+" .gv_source_toggle").each(function(s){$(this).click(function(){gv_toggle_source(this)})});init_scale_image(e);$(e+" .mydbr_tab_wrapper").css("visibility","visible");$(e+" .accordion_wrapper").css("visibility","visible");$(e+" .mydbrselectlist").each(function(){$(this).change(function(){mydbr_selected_cell=this;window.location.href=$(this).val()})});$(e+" .mydbr_tabs").each(function(s){$(this).tabs({fx:{opacity:"toggle",duration:"fast"},active:$(this).attr("data-selected"),load:function(event,ui){init_report_elements("#"+$(ui.panel).attr("id"))}})});$(e+" .accordion").each(function(){var options,options_str=$(this).attr("data-options"),acc_options={autoHeight:false,collapsible:true,heightStyle:"content"},multi={beforeActivate:function(event,ui){var currHeader,currContent,isPanelSelected;if(ui.newHeader[0]){currHeader=ui.newHeader;currContent=currHeader.next(".ui-accordion-content")}else{currHeader=ui.oldHeader;currContent=currHeader.next(".ui-accordion-content")}isPanelSelected=currHeader.attr("aria-selected")=="true";currHeader.toggleClass("ui-corner-all",isPanelSelected).toggleClass("accordion-header-active ui-state-active ui-corner-top",!isPanelSelected).attr("aria-selected",((!isPanelSelected).toString()));currHeader.children(".ui-icon").toggleClass("ui-icon-triangle-1-e",isPanelSelected).toggleClass("ui-icon-triangle-1-s",!isPanelSelected);currContent.toggleClass("accordion-content-active",!isPanelSelected);if(isPanelSelected){currContent.slideUp()}else{currContent.slideDown()}return false}};if(options_str!==undefined){options=jQuery.parseJSON(options_str);if(options.multiopen===true){jQuery.extend(options,multi)}jQuery.extend(acc_options,options)}$(this).accordion(acc_options)})}function export_disable(b){$(document).ready(function(){var f,e,a=b.split(",");for(f=0;f<a.length;f++){$(".hovermenu li."+a[f].toLowerCase()).remove()}e=$(".hovermenu");for(f=0;f<e.length;f++){if($(e[f]).children().length==0){$(e[f]).closest("ul.hovermenu_icon").remove()}}})}function copyIE(b){window.clipboardData.setData("Text",b);alert(mydbr_loc.MYDBR_AA_COPY_TO_CLIPBOARD_OK)}function urldecode(b){return decodeURIComponent(b.replace(/\+/g,"%20"))}function popupclose(j){var l,i,k=null,h=null;if($(j).parents().length==0){j=this}l=$(j).parents(".mydbr_popupframe");i=l.hide().attr("data-closecallback");$("body").css("height","auto").css("width","auto");$(".mydbr_popupframe:visible").each(function(b){var a=parseInt($(this).css("z-index"),10);if(!k||a>k){k=a;h=this}});if(h){$(h).focus()}if(typeof i!==undefined){var g=window[i];if(typeof g==="function"){g(l)}}}function drill_img(){var f,d,e;d="Link"+arguments[1]+"Menu";popuptable=$("#"+d)[0].children[0];f=0;for(f=2;f<arguments.length;f++){e=popuptable.rows[f-1].cells[0];$(e).html(urldecode(arguments[f]))}return !showPopup(d,arguments[0],true)}function move_popup_to_top(i){if(!i){return}var l,g=false,j=i.position(),h,k=parseInt(i.css("z-index"),10);$(".mydbr_popupframe").each(function(a){if(this!=i.get(0)&&$(this).is(":visible")){k=Math.max(k,parseInt($(this).css("z-index"),10)+1);h=$(this).position();if(h.left==j.left&&h.top==j.top){g=true}}});if(g){i.css("left",(j.left+10)+"px");i.css("top",(j.top+10)+"px")}i.css("z-index",k);l=$(document.activeElement);if(i.has(l).length==0&&i!=l){i.focus()}}function popup_check_position(A,C,F){var t,D,u,E,x,y,B,v,s,r,G,z,w,H;if(typeof F=="undefined"){F=false}if(A==""){A=C.find(".popup_content")}r=A.css("overflow-y")?A.css("overflow-y"):"visible";G=A.css("overflow-x")?A.css("overflow-x"):"visible";A.css("overflow-y","initial");A.css("overflow-x","initial");A.css("height","auto");A.css("width","auto");if(is_touch_device()){C.css("position","absolute")}t=$(window).height()-80;D=$(window).width()-20;if(A.height()>t&&!is_touch_device()){A.css("height",t);if(r!="scroll"){C.width(C.width()+25)}A.css("overflow-y","scroll")}if(A.width()>D&&!is_touch_device()){B=C.width()-A.width();A.css("overflow-x","scroll");A.css("width",D);C.width(D+B);C.css("left",5)}if(A.height()>t&&is_touch_device()){$("body").css("height",($(window).scrollTop()+A.height()+100)+"px")}u=C.offset().top;if(C.css("position")!="absolute"){u-=$(window).scrollTop()}H=0;if($("html").hasClass("mobile")||$("html").hasClass("tablet")){H=20}if(u-H<0){u=0+H;C.animate({top:u})}E=u+C.outerHeight();if(E>$(window).height()&&!is_touch_device()){if(F){if(u>$(window).height()){fh=C.find(".border").first().outerHeight()+2;C.animate({top:$(window).height()-fh})}}else{x=E-$(window).height()+10;u=u-x;if(is_touch_device()){u=$(window).scrollTop()+10}if(u<0){u=5}C.animate({top:u})}}E=u+C.outerHeight();y=C.offset().left-$(window).scrollLeft();v=0;if(is_touch_device()){if(C.width()+$(window).scrollLeft()>$(document).width()){v=1}}else{y=C.offset().left;if(C.width()+y>$(document).width()){v=C.width()+y-$(document).width()}}z=0;w=50;if(F){z=C.width()-w}if(y<(-1*z)||v>z){if(is_touch_device()){s=$(window).scrollLeft()+5;if(C.width()+s>$(document).width()){$("body").css("width",(C.width()+10)+"px");s=5}}else{if(v>0){v+=10}if(y<(-1*z)){y=-1*z;C.animate({left:y})}else{C.animate({left:C.offset().left-v+z})}}}if(is_touch_device()){$(C).find(".border > .close").css("margin-left","20px");if(u<($(window).scrollTop())||u>($(window).scrollTop()+$(window).height())){C.css({top:$(window).scrollTop()+$(window).height()/2-C.outerHeight()/2})}}move_popup_to_top($(A).parents(".mydbr_popupframe"))}function embed_title(i){var h,f,j,g;h="";f=/(<div class="title">.*?<\/div>)|(<th colspan="2" class="paramTitle">.*?<\/th>)/i;j=i.match(f);if(j&&j.length>0){h=j[0];h=h.replace(/(<([^>]+)>)/gi,"");i=i.replace(f,"");if(i.substring(0,6).toLowerCase()=="<br>"){i=i.substring(6)}}g=new Object;g.title=h;g.data=i;return g}function embed_set_data(r,q,n,s){var o,v,m,p,u,l;o=$("#"+r).closest(".mydbr_popupframe");v=(q.search('class="param_input')>0);m=o.hasClass("mydbr_popupframe")&&(!new RegExp(/^<script.*<\/script>$/).test(q));if((m)||(v)){p=embed_title(q);if(!v){n=p.title?p.title:n}else{n=unescape(n)}q=p.data}if(!m&&v){r="popup";o=$("#"+r).closest(".mydbr_popupframe")}$("#"+r).html(q);if((m)||(v)){if(typeof s=="undefined"){s=""}if(n!=""){o.find("th").first().find("span").text(n)}o.fadeIn();popup_check_position($("#"+r),o);if(o.find("form.param_input").length==0||o.find("form.param_input").hasClass("in_report_param")){o.find(".border .newwin").show();o.find(".border a.refresh").show();var t="";if(s){t=s.replace("&embedi="+r,"")}if(m&&t!=""){o.attr("data-object",r);o.attr("data-refreshurl",t)}}else{o.find(".border .newwin").hide();o.find(".border a.refresh").hide();o.removeAttr("data-refreshurl")}o.find("form.param_input").submit(function(){u=$(this).serialize();var a=getUrlPath()+"?"+u.replace("&embedi="+r,"");if(r=="popup_parameter"){window.location.href=a;return false}if(m&&a!=""){o.attr("data-object",r);o.attr("data-refreshurl",a)}execute_popup_report(u,n);if(!m){popupclose(this)}return false})}init_report_params("#"+r);if((m)||(v)){popup_check_position($("#"+r),o)}init_report_elements("#"+r);l=q.match(/^<script[^>]*>([\s\S]*?)<\/script>$/ig);if(!$("#"+r).hasClass("no_scroll_to")&&$("#"+r).css("display")!="none"&&q!=""){if(!m&&!l&&!$("#"+r).visible(true)){$.scrollTo($("#"+r),800,{easing:"easeInOutCubic",onAfter:function(){$("#"+r).effect("highlight",500)}})}else{if(!m&&!l){$("#"+r).effect("highlight",500)}}}}function embed_element(z,r,v,t,u){var G,s,x,H,E,D,A,B,y,C,w,F;if(typeof v=="undefined"){v=""}if(typeof u=="undefined"){u=null}if(typeof t!="undefined"&&t!=null&&z!="inline"){mydbr_selected_cell=t}s=false;if(z=="inline"){G=$(t).closest("tr");if(G.length==0){G=$(mydbr_selected_cell).closest("tr")}if(G.length>0){if(G.next().hasClass("inline_report")){G.next().remove();return}z=G.closest("table").attr("id")+"r_"+G.prevAll("tr").not(".inline_report").length;G.after('<tr class="inline_report"><td id="'+z+'" class="inline_report_cell" colspan="'+G.children().length+'"></td></tr>');s=true}}D=false;A="";B="new_popup";y=".content";C="popup";w=z;if(z.slice(-2)=="[]"){D=true;z=z.substr(0,z.length-2)}if(z.indexOf(".")>0){y="#"+z.substr(0,z.indexOf("."));z=z.substr(z.indexOf(".")+1);if(z.indexOf(".")>0){A=z.substr(z.indexOf(".")+1);z=z.substr(0,z.indexOf("."))}}dynamic_popup=((z.slice(0,C.length)==C)&&z!=C)||(w==B);if((D||dynamic_popup)&&!$("#"+z)[0]){E=1;while($("#"+z+E)[0]){E++}if(z==B){z=z+E}if(dynamic_popup){H='<table class="mydbr_popupframe"><tr><th class="border"><a class="close white ui-icon ui-icon-closethick" href="javascript:void(0)"></a><a class="refresh ui-icon white ui-icon-arrowrefresh-1-n" href="javascript:void(0)" style="float: right;"></a><a class="newwin ui-icon white ui-icon-newwin" href="javascript:void(0)"></a><span></span></th></tr><tr><td><div class="popup_content" id="'+z+'"></div></td></tr></table>';$(".content").append($(H));$("#"+z).closest(".mydbr_popupframe").draggable({handle:"th.border",stop:function(){popup_check_position("",$(this),true)}})}else{if(!$(y)[0]){y=y.substr(1);alert("Missing target embed object '"+y+"'.\nCreate the object using command:\nselect 'dbr.embed_object', '"+y+"';");return}else{$(y).append($('<div id="'+z+'" class="'+A+'"></div>'))}}}F=$("#"+z).closest(".mydbr_popupframe");F.attr("tabIndex",-1).css("outline","0");if(!$("#"+z)[0]){alert("Missing target embed object '"+z+"'.\nCreate the object using command:\nselect 'dbr.embed_object', '"+z+"';");return}if(u){F.attr("data-closecallback",u)}x=r;if(z!=="popup_parameter"){x+="&hdr=0"}$.ajax({url:s?x+"&embed=3":x,type:"get",data:{embedi:z},success:function(a){embed_set_data(z,a,v,(z=="inline"?x+"&embedi=1":x+"&embedi="+z));if(s){$("#"+z).prepend('<div style="position: relative;"><button class="ui-button ui-state-default ui-corner-all ui-button-icon-only inline_newwin" data-url="'+r+'" role="button" aria-disabled="false" style="position: absolute;right: 24px;top:-24px;"><span class="ui-button-icon-primary ui-icon ui-icon-newwin"></span><span class="ui-button-text">close</span></button><button class="ui-button ui-state-default ui-corner-all ui-button-icon-only inline_close" role="button" aria-disabled="false" style="position: absolute;right: 0px;top:-24px;"><span class="ui-button-icon-primary ui-icon ui-icon-close"></span><span class="ui-button-text">close</span></button></div>')}}})}function execute_popup_report(e,g){var f,h;if(e.substr(0,7)!="http://"&&e.substr(0,8)!="https://"){f=getUrlPath()+"?"+e}else{f=e}h=gup(f,"embedi");if(!h){h="popup"}$.ajax({url:f,type:"get",success:function(a){if(a){embed_set_data(h,a,g,f)}else{$(".mydbr_popupframe").hide();$("#"+h).html("")}}})}function drill_set(p,l){var n,m,k,o,j,i;mydbr_selected_cell=l;o=$("#"+p)[0].children[0];k=l.lastChild?l.lastChild:l.next();for(m=0;m<k.children.length;m++){n=k.children[m].firstChild.cloneNode(true);if(n.href.indexOf("embed_element")>0){n.href=n.href.replace(/%/g,"%25")}j=o.rows[m+1].cells[0];j.replaceChild(n,j.firstChild);$(o.rows[m+1]).show()}i=o.rows.length-1-k.children.length;if(i>0){for(var m=0;m<i;m++){$(o.rows[o.rows.length-1-m]).hide()}}}function CopyTable(n,h){var l="",j=false,i,k,m=document.getElementById(n);for(i=0;i<m.rows.length;i++){if($(m.rows[i]).parent().hasClass("tableFloatingHeader")){continue}if(i!=0&&l!=""){l=l+"\n";if(j){l=l+"\t";j=false}}for(k=0;k<m.rows[i].cells.length;k++){if(m.rows[i].cells[k].className!="invisible"&&!$(m.rows[i].cells[k]).hasClass("drill")&&m.rows[i].cells[k].className!="dbrResultSetTitle"){if(m.rows[i].cells[k].className=="cell_ct_top"){if(m.rows[i].cells[k].rowSpan==2){j=true}}if(k!=0){l=l+"\t"}if($(m.rows[i].cells[k]).hasClass("summary")){l=l+'"'+$(m.rows[i].cells[k]).text()+'"'}else{l=l+$(m.rows[i].cells[k]).text()}}}}if(h===undefined){return l}else{copyIE(l)}}function HideDL(b){$("#iedl_"+b).slideDown()}function NetwExport(b){$("#iedl_"+b).slideDown();$("#iedl_"+tableID).effect("shake",{distance:5})}function NetwSrc(f){var d=document.getElementById("tool_"+id),e=document.getElementById("tab_"+id);if(e.style.display=="none"){d.src="images/tab_d.gif";e.style.display=""}else{d.src="images/tab_r.gif";e.style.display="none"}}function gv_toggle_source(b){$(b).toggleClass("arrow_right");$(b).toggleClass("arrow_down");$(b).parents(".gvchart").find(".gvsource").toggle()}function Tools(c){var d=$(c).siblings(".search_div");if($(c).hasClass("arrow_right")){$(d).removeClass("search");$(d).css("display","none");$(c).removeClass("arrow_right");$(c).addClass("arrow_down");d.show("slide",{direction:"up",complete:function(){if(!$(c).hasClass("no_focus")){d.find(".findit").focus()}}})}else{$(c).removeClass("arrow_down");$(c).addClass("arrow_right");d.slideUp();$(d).addClass("search")}mydbr_table_changed($(c).closest("table").attr("id"))}function getHdrCell(c,i,h){var j=0,g=0;while(i.cells.length>j&&(c+i.cells[j].colSpan+g)<h+1){g+=i.cells[j].colSpan;j++}if(i.cells.length>j){return $(i.cells[j]).text()}else{return""}}function tt(j){if(j.title!=""||$(j).hasClass("drill")){return}var m=$(j).closest("tr"),n=$(j).closest("table"),k="",h,l,i;i=$(n).find("thead:not(.tableFloatingHeader) tr:not(.selectfilter,.textfilter)");if(i.length==1){return}nbrOfHdr=i[0].cells[0].colSpan;l=i.length;for(h=0;h<nbrOfHdr;h++){k+=$(m[0].cells[h]).text()+" "}k+=" / ";if(l==1){k+=$(n.rows[1].cells[j.cellIndex]).text()}else{k+=$(i[0].cells[1]).text()+" ";if(l==3){k+=getHdrCell(nbrOfHdr,i[1],j.cellIndex);if(l>1){k+=" / "+getHdrCell(1,i[2],j.cellIndex+1)}}else{if(l==2){k+=getHdrCell(1,i[1],j.cellIndex+1)}}}j.title=k}function autosum_int(g,h,f,e){if(typeof g!="object"){g=this}if(typeof h!="number"){h=g.cellIndex+1}if(typeof f!="string"){f=""}if(typeof e!="string"){e=""}ct_total(g,h-1,0,f,e);col_sum(g,h-1,0,f,e)}function autosum_float(h,i,g,f,j){if(typeof h!="object"){h=this}if(typeof i!="number"){i=h.cellIndex+1}if(typeof g!="number"){g=2}if(typeof f!="string"){f=""}if(typeof j!="string"){j=""}ct_total(h,i-1,g,f,j);col_sum(h,i-1,g,f,j)}function ct_total(m,r,o,l,j){var p,k,n,q;n=$(m).attr("data-ct_col");q=$(m).parent().find("."+n);if(q.length==0||n=="undefined"){return}p=q.attr("data-ct_oper");total=p=="sum"?0:null;$(m).parent().find('[data-ct_col="'+n+'"]').each(function(b,a){k=cell_value_get($(this),o,null,l,j);if(total==null||k==null){total=(k==null)?total:k}else{if(p=="sum"){total+=k}else{if(p=="min"){total=(k<total)?k:total}else{if(p=="max"){total=(k>total)?k:total}}}}});cell_value_set(q,total,o,l,j);col_sum(m,q.index(),o,l,j)}function cell_value_get(g,f,e,h){if(typeof f!="number"){f=0}if(typeof e!="string"){e=""}if(typeof h!="string"){h=""}val=$(g).text();val=val.replace(mydbr_sorting.separator.thousand,"");val=val.replace(mydbr_sorting.separator.decimal,".");if(typeof val=="string"){val=val.replace(/[^\d\.-]/g,"")}if(val==""){return null}return val?parseFloat(val):0}function cell_value_set(i,h,g,f,j){if(typeof g!="number"){g=0}if(typeof f!="string"){f=""}if(typeof j!="string"){j=""}$(i).html(f+number_format(h,g,mydbr_sorting.separator.decimal,mydbr_sorting.separator.thousand)+j)}function col_value_text(e,f,g){var h=e.parentNode;if(typeof f!="number"){f=e.cellIndex+1}if(arguments.length>2){$(h.cells[f-1]).html(g)}return $(h.cells[f-1]).html()}function col_value_get(j,g,h,l,k){var i;if(typeof g!="number"){g=j.cellIndex+1}i=$(j).closest("tr").children().eq(g-1);if(i.length==0){return null}return cell_value_get(i,h,l,k)}function col_value_set(l,h,i,j,n,m){var k=$(l).closest("tr").children().eq(h-1);if(k.length==0){return null}cell_value_set(k,j,i,n,m)}function col_aggregate(aa,O,S,M,F,Y){var U,I,G,N,W,T,K,i=[],C=[],P=[],L=[],V,X,E,R,H,Q,ab,J,D,Z;tbody=$(O).closest("table").find("tbody")[0];if(typeof S!="number"){S=O.cellIndex}if(typeof M!="number"||aa=="count"){M=0}if(typeof F!="string"){F=""}if(typeof Y!="string"){Y=""}Q=$(O).closest("table").find("thead").children().last().children("th:nth-child("+(S+1)+")").attr("data-datatype");G=0;N=0;W=undefined;T=undefined;for(U=0;U<tbody.rows.length;U++){if($(tbody.rows[U]).hasClass("summary_row")){V=$(tbody.rows[U].cells[S]);if(V.hasClass("summary_level0")){X=0}else{if(V.hasClass("summary_level1")){X=1}else{if(V.hasClass("summary_level2")){X=2}else{if(V.hasClass("summary_level3")){X=3}else{if(V.hasClass("summary_level4")){X=4}}}}}for(E=0;E<=X;E++){if(typeof i[E]=="undefined"){i[E]=G}else{i[E]+=G}if(typeof C[E]=="undefined"){C[E]=N}else{C[E]++}if(typeof P[E]=="undefined"){P[E]=W}else{D=Cell_data.get_value_raw(W,Q);Z=Cell_data.get_value_raw(P[E],Q);if(D<Z){P[E]=W}}if(typeof L[E]=="undefined"){L[E]=T}else{D=Cell_data.get_value_raw(T,Q);Z=Cell_data.get_value_raw(L[E],Q);if(D>Z){L[E]=T}}switch(aa){case"sum":ab=i[X];R=mydbr_sorting.sum_prefix;break;case"count":ab=C[X];R=mydbr_sorting.count_prefix;break;case"min":ab=P[X];R=mydbr_sorting.min_prefix;break;case"max":ab=L[X];R=mydbr_sorting.min_prefix;break;case"avg":ab=i[X]/C[X];R=mydbr_sorting.avg_prefix;break;default:}}if(Q=="int"||Q=="float"){J=number_format(ab,M,mydbr_sorting.separator.decimal,mydbr_sorting.separator.thousand)}else{if((Q=="date"||Q=="time")&&typeof ab=="number"){J=Cell_data.get_formatted(ab,Q)}else{J=ab}}if(typeof J=="undefined"){J=""}V.html(R+" "+F+J+Y);if(X==0){return ab;break}else{for(E=X;E<i.length;E++){i[E]=0;C[E]=0;P[E]=undefined;L[E]=undefined}G=0;N=0;W=undefined;T=undefined}}else{if($(tbody.rows[U]).hasClass("no_mydbr_count")||$(tbody.rows[U].cells[S]).hasClass("no_mydbr_count")||!$(tbody.rows[U]).is(":visible")){continue}K=$(tbody.rows[U].cells[S]).text();if(K!=""){if(Q!="char"){G+=parseFloat(Cell_data.get_value_raw(K,Q))}N++;if(typeof W=="undefined"){if(Q=="int"||Q=="float"){W=Cell_data.get_value_raw(K,Q)}else{W=K}}else{D=Cell_data.get_value_raw(K,Q);Z=Cell_data.get_value_raw(W,Q);if(D<Z){W=K}}if(typeof T=="undefined"){if(Q=="int"||Q=="float"){T=Cell_data.get_value_raw(K,Q)}else{T=K}}else{D=Cell_data.get_value_raw(K,Q);Z=Cell_data.get_value_raw(T,Q);if(D>Z){T=K}}}}}return J}function col_sum(s,x,v,q,n){var i,p,w,r=[],o,u,t;tbody=$(s).closest("table").find("tbody")[0];if(typeof x!="number"){x=s.cellIndex}if(typeof v!="number"){v=0}if(typeof q!="string"){q=""}if(typeof n!="string"){n=""}p=0;for(i=0;i<tbody.rows.length;i++){if($(tbody.rows[i]).hasClass("summary_row")){o=$(tbody.rows[i].cells[x]);if(o.hasClass("summary_level0")){u=0}else{if(o.hasClass("summary_level1")){u=1}else{if(o.hasClass("summary_level2")){u=2}else{if(o.hasClass("summary_level3")){u=3}else{if(o.hasClass("summary_level4")){u=4}}}}}for(t=0;t<=u;t++){if(typeof r[t]=="undefined"){r[t]=p}else{r[t]+=p}}o.html(mydbr_sorting.sum_prefix+" "+q+number_format(r[u],v,mydbr_sorting.separator.decimal,mydbr_sorting.separator.thousand)+n);if(u==0){return p[u];break}else{for(t=u;t<r.length;t++){r[t]=0}p=0}}else{if($(tbody.rows[i]).hasClass("no_mydbr_count")||$(tbody.rows[i].cells[x]).hasClass("no_mydbr_count")||!$(tbody.rows[i]).is(":visible")){continue}w=$(tbody.rows[i].cells[x]).html();w=Cell_data.get_value_raw(w,"float");if(!isNaN(w)){p+=parseFloat(w)}}}return p}function editable_select(){var select,callback,editable_id,cell,i;switch(arguments[1].type){case"radiobutton":default:if(arguments[1].data!==undefined){select=eval("("+arguments[1].data+")");if(select.length>0&&typeof select[0]==="object"){for(i=0;i<select.length;i++){if(select[i]["i"]==arguments[0]){$(this).html(select[i]["v"]);break}}}else{$(this).html(select[arguments[0]])}}editable_id=arguments[0];cell=this;if(arguments[1].loadurl!==undefined){$.ajax({url:arguments[1].loadurl,async:false,success:function(result){select=eval("("+result+")");$(cell).html(select[editable_id])}})}}if(arguments[1].callback_user){callback=arguments[1].callback_user;callback.apply(this,[arguments[0],arguments[1]])}}function import_start(c){var d=$("#ul_form_"+c+' label [name="mydbrimport"]');if(d.length&&d.val()==""){alert(mydbr_loc.MYDBR_IMPORT_SELECT);return false}else{$("#ul_form_"+c).hide();$("#ul_process_"+c).show();return true}}function import_stop(g,e,h){var f="";$("#im_nok_"+g).hide();$("#im_ok_"+g).hide();$("#im_msg_"+g).hide();$("#ul_process_"+g).hide();if(h!=""){$("#im_msg_"+g).html(h);$("#im_msg_"+g).show()}else{if(e){$("#im_ok_"+g).show()}else{$("#im_nok_"+g).show()}}$("#ul_form_"+g).html(f+"<label>"+mydbr_loc.MYDBR_IMPORT_FILE+' <input name="mydbrimport" type="file" size="30"><br></label><label><input type="submit" value="'+mydbr_loc.MYDBR_IMPORT_IMPORT+'"></label>');$("#ul_form_"+g).show();$.ajax({url:"lib/import_result.php",type:"get",data:{id:g},success:function(a){$("#im_"+g+" > .result").show().html(a);$("#im_"+g+" > .content").hide()}});return true}function set_scrollable_position(b){b.closest(".scrolling_area").scrollTop($("tr.scrollable_top",b).offset().top-$("tbody tr:first",b).offset().top)}$.tablesorter.addWidget({id:"saveSort",format:function(e){var d,f=$(e);if(f.hasClass("sort_rmbr")){if(e.config.debug){d=new Date()}if(f.hasClass("has_sort_rmbr")&&e.config.hasInitialized){$.ajax({url:"lib/sort_remember.php",type:"post",data:{table_id:f.attr("id"),report:getURLParameter("r"),sortlist:JSON.stringify(e.config.sortList)}})}else{f.addClass("has_sort_rmbr")}if(e.config.debug){$.tablesorter.benchmark("Applying saveSort widget",d)}}}});function showPopup(g,l,h){var j,k,i;if(l){hideCurrentPopup(l);l.cancelBubble=true;i=get_event_coord(l,-5,-5,true);j=l.target?l.target:l.srcElement;changeObjectVisibility(g,"block");k=$("#"+g).parentRelative();i.x-=k.left;i.y-=k.top;if(h){moveObject(g,i)}window.currentlyVisiblePopup=g;return true}else{return false}}function elementOrParentIsFixed(h){var e=$(h),f=e.add(e.parents()),g=false;f.each(function(){if($(this).css("position")==="fixed"){g=true;return false}});return g}function get_event_coord(j,f,i,g){var h=new Object();if(j.pageY&&!$.browser.msie){h.x=j.pageX+f;h.y=j.pageY+i;if(g&&elementOrParentIsFixed(j.currentTarget)){h.x-=document.body.scrollLeft;h.y-=document.body.scrollTop}}else{h.x=j.clientX+document.documentElement.scrollLeft+f;h.y=j.clientY+document.documentElement.scrollTop+i;if(g&&elementOrParentIsFixed(j.currentTarget)){h.x-=document.documentElement.scrollLeft;h.y-=document.documentElement.scrollTop}}return h}function hideCurrentPopup(k){var l,n,m,h,e,j;m=window.event||k;if(m.button==2){return}if(window.currentlyVisiblePopup){coord=get_event_coord(m,0,0,false);h=$("#"+window.currentlyVisiblePopup).width();e=$("#"+window.currentlyVisiblePopup).height();j=$("#"+window.currentlyVisiblePopup).offset();l=coord.x<j.left||(coord.x>(j.left+h));n=coord.y<j.top||(coord.y>(j.top+e));if((l)||(n)){changeObjectVisibility(window.currentlyVisiblePopup,"none");window.currentlyVisiblePopup=false}}}window.onload=initializeHacks;document.onclick=hideCurrentPopup;function initializeHacks(){if((navigator.appVersion.indexOf("MSIE 5")!=-1)&&(navigator.platform.indexOf("Mac")!=-1)&&getStyleObject("blankDiv")){window.onresize=explorerMacResizeFix}resizeBlankDiv();createFakeEventObj()}function createFakeEventObj(){if(!window.event){window.event=false}}function resizeBlankDiv(){if((navigator.appVersion.indexOf("MSIE 5")!=-1)&&(navigator.platform.indexOf("Mac")!=-1)&&getStyleObject("blankDiv")){getStyleObject("blankDiv").width=document.body.clientWidth-20;getStyleObject("blankDiv").height=document.body.clientHeight-20}}function explorerMacResizeFix(){location.reload(false)}function getStyleObject(b){if(document.getElementById&&document.getElementById(b)){return document.getElementById(b).style}else{if(document.all&&document.all(b)){return document.all(b).style}else{if(document.layers&&document.layers[b]){return document.layers[b]}else{return false}}}}function changeObjectVisibility(e,f){var d=getStyleObject(e);if(d){d.display=f;return true}else{return false}}function moveObject(i,k){var p,o=getStyleObject(i),j,l=get_x_size(),m,n;j=document.getElementById(i).offsetWidth-10;m=get_x_scroll();if((k.x+j)>l){n=l-j-10+m;k.x=(n<k.x)?n:k.x}if(o){o.left=k.x+"px";o.top=(k.y-5)+"px";p=$("#"+i).parentRelative();if((p.left!=0||p.top!=0)&&($("#"+i).offset().left+j>l)){to_left=$("#"+i).offset().left+j-l;k.x-=to_left+10+m;o.left=k.x+"px"}return true}else{return false}}function get_x_size(){var b=0;if(document.documentElement&&document.documentElement.clientWidth){b=document.documentElement.clientWidth}else{if(document.body&&document.body.clientWidth){b=document.body.clientWidth}else{if(window.innerWidth){b=window.innerWidth-18}}}return b}function get_x_scroll(){var b;if(window.pageXOffset){b=window.pageXOffset}else{if(window.event){b=document.documentElement.scrollLeft+document.body.scrollLeft}else{b=window.scrollX}}return b}function onMenu(d,c){c.style.cursor="pointer";document.getElementById(d).style.backgroundColor="#B0FE86"}function offMenu(b){document.getElementById(b).style.color="#000000";document.getElementById(b).style.backgroundColor="#FFFFFF"}(function(b){b.mydbr_pager=function(O,M){var E={},L=this,J,P=b(O),a=P.find(".pager_first_d"),y=P.find(".pager_prev_d"),D=P.find('input[name="page"]'),N=P.find(".max"),w=P.find(".pager_next"),z=P.find(".pager_last"),G=P.find('input[name="length"]'),x=P.find('input[name="start"]'),C=P.find('input[name="end"]'),K=function(){var k=P.closest("table"),c=parseInt(D.val(),10),f=parseInt(x.val(),10),i=parseInt(C.val(),10),g=parseInt(G.val(),10),d=((c-1)*g)+1,e=(c*g),j,h;h=k.find("TBODY").children().length-k.find(".last_row").length;f=isNaN(f)?0:f;i=isNaN(i)?0:i;if(e>h&&h>0){e=h}J=new Date().getTime();for(j=f;j<=i;j+=1){k.find("tbody tr").eq(j-1).hide()}for(j=d;j<=e;j+=1){k.find("tbody tr").eq(j-1).show()}b('.pager_row input[name="page"]',k).val(c);b('.pager_row input[name="start"]',k).val(d);b('.pager_row input[name="end"]',k).val(e);if(parseInt(D.val(),10)<parseInt(N.text(),10)){b(".pager_row .pager_next",k).removeClass("pager_next_d").removeAttr("disabled");b(".pager_row .pager_last",k).removeClass("pager_last_d").removeAttr("disabled")}else{b(".pager_row .pager_next",k).addClass("pager_next_d").attr("disabled","disabled");b(".pager_row .pager_last",k).addClass("pager_last_d").attr("disabled","disabled")}if(parseInt(D.val(),10)>1){b(".pager_row .pager_prev",k).removeClass("pager_prev_d").removeAttr("disabled");b(".pager_row .pager_first",k).removeClass("pager_first_d").removeAttr("disabled")}else{b(".pager_row .pager_prev",k).addClass("pager_prev_d").attr("disabled","disabled");b(".pager_row .pager_first",k).addClass("pager_first_d").attr("disabled","disabled")}b.sparkline_display_visible()},H=function(){D.val(1);K()},B=function(){D.val(parseInt(D.val(),10)-1);K()},A=function(){D.val(parseInt(D.val(),10)+1);K()},F=function(){D.val(parseInt(N.text(),10));K()},I=function(){var c=parseInt(D.val(),10);if(isNaN(c)||c<1){D.val(1)}else{if(c>parseInt(N.text(),10)){D.val(N.text())}}K()};L.settings={};L.init=function(){L.settings=b.extend({},E,M);var c=P.closest("table"),e=G.val(),d;D.val(1);d=c.find("TBODY").children().length-c.find(".last_row").length;N.text(d>0?Math.ceil(d/e):1);a.on("click",function(){H()});y.on("click",function(){B()});w.on("click",function(){A()});z.on("click",function(){F()});D.on("change",function(){I()});K()};L.init()};b.fn.mydbr_pager=function(a){return this.each(function(){if(undefined===b(this).data("mydbr_pager")){var d=new b.mydbr_pager(this,a);b(this).data("mydbr_pager",d)}})}}(jQuery));