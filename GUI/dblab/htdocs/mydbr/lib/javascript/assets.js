(function(a){a.fn.parentRelative=function(){var b,d={},c;d.left=0;d.top=0;c=a(this);while(c.offsetParent()[0].tagName!=="BODY"&&c.offsetParent()[0].tagName!=="HTML"){b=c.offsetParent().position();d.left+=b.left;d.top+=b.top;c=c.offsetParent()}return d}}(jQuery));function makeEvent(b,e,d,c){function a(){return e(d)}if(b.addEventListener){b.addEventListener(c,a,false)}else{if(b.attachEvent){b.attachEvent("on"+c,a)}}}function appbar(a){if(a==0){window.location="logout.php"}else{if(a==1){document.forms.menubarform.app.value="passwd"}else{document.forms.menubarform.app.value="admin0"}document.forms.menubarform.submit()}}String.prototype.unescapeHtml=function(){var b,a;b=document.createElement("div");b.innerHTML=this;a=b.childNodes[0].nodeValue;b.removeChild(b.firstChild);return a};function getTableCell(b,c){var a=b.parentNode.parentNode.cells[c].innerHTML;if(a.length==0){return""}return a.unescapeHtml()}function datepicker(a){$(a).datepicker({showButtonPanel:true,altFormat:"yy-mm-dd"})}function search_table(e,c){var g=e.value.toLowerCase().split(" "),j,d,a,f,h,b;if(j===null){j=$(e).closest("table")}else{j=document.getElementById(c)}b=$(j).width();for(a=1;a<j.rows.length;a++){if(j.rows[a].cells[0].nodeName.toLowerCase()!="th"){d=$(j.rows[a]).find("td").clone().children(".drillmenuitems").remove().end().text();h="none";for(f=0;f<g.length;f++){if(d.toLowerCase().indexOf(g[f])>=0){h=""}else{h="none";break}}j.rows[a].style.display=h}}$(j).width(b)}function htmlspecialchars_decode(b,f){var d=0,c=0,e=false,a;if(typeof f==="undefined"){f=2}b=b.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");a={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(f===0){e=true}if(typeof f!=="number"){f=[].concat(f);for(c=0;c<f.length;c++){if(a[f[c]]===0){e=true}else{if(a[f[c]]){d=d|a[f[c]]}}}f=d}if(f&a.ENT_HTML_QUOTE_SINGLE){b=b.replace(/&#0*39;/g,"'")}if(!e){b=b.replace(/&quot;/g,'"')}b=b.replace(/&amp;/g,"&");return b}function sprintf(){var g,h,b,c,k,e,d,f,j;g=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g;h=arguments;f=0;j=h[f++];b=function(n,a,i,m){if(!i){i=" "}var l=(n.length>=a)?"":Array(1+a-n.length>>>0).join(i);return m?n+l:l+n};c=function(m,l,p,a,i,o){var n=a-m.length;if(n>0){if(p||!i){m=b(m,a,o,p)}else{m=m.slice(0,l.length)+b("",n,"0",true)+m.slice(l.length)}}return m};k=function(p,o,n,q,i,a,m){var l=p>>>0;n=n&&l&&{"2":"0b","8":"0","16":"0x"}[o]||"";p=n+b(l.toString(o),a||0,"0",false);return c(p,n,q,i,m)};e=function(m,o,i,a,l,n){if(a!=null){m=m.slice(0,a)}return c(m,"",o,i,l,n)};d=function(z,m,n,r,B,w,l){var v,a,u,i,A,t,s=false,o="",q=false,y=false,x=" ",p;if(z=="%%"){return"%"}p=n.length;for(v=0;n&&v<p;v++){switch(n.charAt(v)){case" ":o=" ";break;case"+":o="+";break;case"-":s=true;break;case"'":x=n.charAt(v+1);break;case"0":q=true;break;case"#":y=true;break}}if(!r){r=0}else{if(r=="*"){r=+h[f++]}else{if(r.charAt(0)=="*"){r=+h[r.slice(1,-1)]}else{r=+r}}}if(r<0){r=-r;s=true}if(!isFinite(r)){throw new Error("sprintf: (minimum-)width must be finite")}if(!w){w="fFeE".indexOf(l)>-1?6:(l=="d")?0:undefined}else{if(w=="*"){w=+h[f++]}else{if(w.charAt(0)=="*"){w=+h[w.slice(1,-1)]}else{w=+w}}}t=m?h[m.slice(0,-1)]:h[f++];switch(l){case"s":return e(String(t),s,r,w,q,x);case"c":return e(String.fromCharCode(+t),s,r,w,q);case"b":return k(t,2,y,s,r,w,q);case"o":return k(t,8,y,s,r,w,q);case"x":return k(t,16,y,s,r,w,q);case"X":return k(t,16,y,s,r,w,q).toUpperCase();case"u":return k(t,10,y,s,r,w,q);case"i":case"d":a=parseInt(+t,10);u=a<0?"-":o;t=u+b(String(Math.abs(a)),w,"0",false);return c(t,u,s,r,q);case"e":case"E":case"f":case"F":case"g":case"G":a=+t;u=a<0?"-":o;i=["toExponential","toFixed","toPrecision"]["efg".indexOf(l.toLowerCase())];A=["toString","toUpperCase"]["eEfFgG".indexOf(l)%2];t=u+Math.abs(a)[i](w);return c(t,u,s,r,q)[A]();default:return z}};return j.replace(g,d)}function number_format(f,c,h,e){f=(f+"").replace(",","").replace(" ","");var b=!isFinite(+f)?0:+f,a=!isFinite(+c)?0:Math.abs(c),j=(typeof e==="undefined")?",":e,d=(typeof h==="undefined")?".":h,i="",g=function(o,m){var l=Math.pow(10,m);return""+Math.round(o*l)/l};i=(a?g(b,a):""+Math.round(b)).split(".");if(i[0].length>3){i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,j)}if((i[1]||"").length<a){i[1]=i[1]||"";i[1]+=new Array(a-i[1].length+1).join("0")}return i.join(d)}function parse_num_attr(href){var src=href.substr(href.indexOf("?")+1),attr,attrs=src.split("&"),str="{",i;for(i=0;i<attrs.length;i++){attr=attrs[i].split("=");if(i>0){str+=","}str+=attr[0]+":"+attr[1]}str+="}";return eval("("+str+")")}function is_touch_device(){return(typeof Touch==="object")}function init_scale_image(c){var b,a;b=(c)?c:"";$(b+" div.scale_image").each(function(f){var e,d;if($(this).css("position")!="absolute"){$(this).css("left",$(this).position().left+"px");$(this).css("position","absolute");$(this).css("top",($(this).position().top-25)+"px");e=$($(this).next()[0].useMap).first().children();for(d=0;d<e.length;d++){$.data(e[d],"coords",e[d].coords)}}$(this).slider({value:100,min:10,max:100,slide:function(i,j){var l,h=$(this).next()[0],m,k,g=j.value/100;if(h.style.height!="auto"){$.data(this,"width",$(h).width());$.data(this,"left",$(h).position().left)}l=$.data(this,"width");m=0;k=1;g=m+(g*(k-m));h.style.width=(g*l)+"px";h.style.height="auto";$(h).position().left=$.data(this,"left")},change:function(l,n){var o,m,g,j,k,h=$($(this).next()[0].useMap).first().children();for(j=0;j<h.length;j++){m="";g=$.data(h[j],"coords").split(" ");for(k=0;k<g.length;k++){a=g[k].split(",");for(o=0;o<a.length;o++){a[o]=Math.round(a[o]*n.value/100);m+=a[o];if(o+1!=a.length){m+=","}}if(k+1!=g.length){m+=" "}}h[j].coords=m}}})})}$.fn.serializeObject=function(){var c={},b=this.serializeArray();$.each(b,function(){if(c[this.name]){if(!c[this.name].push){c[this.name]=[c[this.name]]}c[this.name].push(this.value||"")}else{c[this.name]=this.value||""}});return c};function getUrlVars(){var b,d=[],c,a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(b=0;b<a.length;b++){c=a[b].split("=");d.push(c[0]);d[c[0]]=c[1]}return d}function getURLParameter(a){return decodeURI((RegExp(a+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function getUrlPath(){var a=window.location;return a.protocol+"//"+a.host+a.pathname}function array_identical(d,c){var e=d.length;if(e!=c.length){return false}while(e--){if(d[e]!==c[e]){return false}}return true}(function(c){var b=c(window);c.fn.viewportOffset=function(){var a=c(this).offset();return{left:a.left-b.scrollLeft(),top:a.top-b.scrollTop()}}})(jQuery);function resize_codemirror(c,b){var a;if(typeof b==="undefined"){b=120}if(!editor.space_below){editor.space_below=b}a=$(window).height()-$(".CodeMirror").offset().top-editor.space_below;editor.setSize("100%",a+"px")}function unicodeToChar(a){return a.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(b){return String.fromCharCode(parseInt(b.replace(/\\u/g,""),16))})}jQuery.uaMatch=function(b){b=b.toLowerCase();var a=(/(chrome)[ \/]([\w.]+)/.exec(b))||(/(webkit)[ \/]([\w.]+)/.exec(b))||(/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b))||(/(msie) ([\w.]+)/.exec(b))||b.indexOf("compatible")<0&&(/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b))||[];return{browser:a[1]||"",version:a[2]||"0"}};if(!jQuery.browser){matched=jQuery.uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else{if(browser.webkit){browser.safari=true}}jQuery.browser=browser}function Countdown(i){var a,g=this,d=i.seconds||10,f=i.onUpdateStatus||function(){},e=i.onCounterEnd||function(){},h=i.display_obj||"refresh_counter",b="go";function c(){if(b=="go"){d--;f(d);if(d<=0){g.stop();e()}}}this.start=function(){clearInterval(a);a=0;a=setInterval(c,1000)};this.stop=function(){clearInterval(a)};this.toggle=function(){$("."+h).toggleClass("paused");if(b=="go"){b="pause"}else{d=parseInt($("."+h).text(),10);b="go"}}}function isIE(){return(navigator.userAgent.indexOf("MSIE")!==-1||navigator.appVersion.indexOf("Trident/")>0)}function csrf_token_get(){return $("#csrf_token").val()}function gup(b,e){var a,d,c;e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a="[\\?&]"+e+"=([^&#]*)";d=new RegExp(a);c=d.exec(b);if(c==null){return""}else{return c[1]}}jQuery.extend({getQueryParameters:function(a){return(a||document.location.search).replace(/(^\?)/,"").split("&").map(function(b){return b=b.split("="),this[b[0]]=b[1],this}.bind({}))[0]}});$(document).ready(function(){$(document).on("click",".param_input .checkboxitem",function(){set_param_cb_value(this)});$(document).on("click",".param_input .optgroupcb",function(){select_opt_group(this)});$(document).on("change",".param_daterange",function(){user_date_range(this)});init_report_params("")});function is_IE8(){return $.browser.msie&&+$.browser.version===8}function user_date_range(c){var e,j,l,f=$(c).prevAll("input"),b,h,k,d,m=mydbr_sorting.dateformat.replace("d","DD").replace("m","MM").replace("Y","YYYY").substr(0,10),i=mydbr_sorting.dateformat.replace("d","DD").replace("m","MM").replace("Y","YYYY").replace("i","mm").replace("s","ss"),a,g;if(c.value=="none"){return}if(f.length>1){l=$(f[1]);j=$(f[0]);a=l.hasClass("datetimepick")?i:m;g=j.hasClass("datetimepick")?i:m}if(f.length==1){l=$(f[0]);a=l.hasClass("datetimepick")?i:m}if($.browser.safari&&is_touch_device()){a=l.hasClass("datetimepick")?"YYYY-MM-DDTHH:mm:ss":"YYYY-MM-DD";if(typeof(j)!=="undefined"){g=j.hasClass("datetimepick")?"YYYY-MM-DDTHH:mm:ss":"YYYY-MM-DD"}}e=JSON.parse(c.value);if(e.from.type=="day"){l.val(moment().add(e.from.value,"day").startOf("day").format(a));if(typeof(j)!=="undefined"){j.val(moment().add(e.to.value,"day").endOf("day").format(g))}}if(e.from.type=="month"||e.from.type=="year"){if(e.to.value==null){l.val(moment().startOf(e.from.type).startOf("day").format(a));if(typeof(j)!=="undefined"){j.val(moment().endOf(e.to.type).format(g))}}else{if(e.from.value<0&&e.to.value<0){l.val(moment().startOf(e.from.type).add(e.from.value,e.from.type).format(a));if(typeof(j)!=="undefined"){j.val(moment().add(e.to.value,e.from.type).endOf(e.from.type).format(g))}}else{l.val(moment().add(e.from.value,e.from.type).startOf("day").add(1,"day").format(a));if(typeof(j)!=="undefined"){j.val(moment().add(e.to.value,e.to.type).endOf("day").format(g))}}}}if(e.from.type=="quarter"){if(e.to.value==null){l.val(moment().startOf("quarter").format(a));if(typeof(j)!=="undefined"){j.val(moment().endOf("quarter").format(g))}}else{l.val(moment().startOf("quarter").add(e.from.value,"quarter").format(a));if(typeof(j)!=="undefined"){j.val(moment().add(e.to.value,"quarter").endOf("quarter").format(g))}}}}function init_report_params(a){$(a+" .init_scb").scrollcheckbox();if(!is_touch_device()&&!is_IE8()){if(!window.Modernizr.inputtypes.date){$(a+" .param_input .datetimefilter").each(function(){var b;if($(this).attr("data-format_am")=="ampm"){b=["am","pm"]}else{b=["AM","PM"]}$(this).datetimeEntry({datetimeFormat:$(this).attr("data-format"),spinnerImage:"",ampmNames:b})})}}set_optgroup_state(a);$(a+" .autosize_animate").autosize({append:"\n"});if((!window.Modernizr.inputtypes.date||!is_touch_device())){$(a+" .datepick").each(function(){if(!is_IE8()){$(this).attr("type","text")}var b={showOtherMonths:true,selectOtherMonths:true,showButtonPanel:true,changeMonth:true,changeYear:true,showOn:"button",buttonImage:"lib/external/jquery/css/images/calendar.png",buttonImageOnly:true,dateFormat:$(this).attr("data-dateformat")};if($(this).attr("data-years")){b.yearRange=$(this).attr("data-years")}$(this).datepicker(b)})}else{$(a+" .datepick").each(function(){$(this).val($(this).attr("data-stddatetime"))})}if(!window.Modernizr.inputtypes["datetime-local"]||!is_touch_device()){$(a+" .datetimepick").each(function(){if(!is_IE8()){$(this).attr("type","text")}var b={showOtherMonths:true,selectOtherMonths:true,showButtonPanel:true,changeMonth:true,changeYear:true,showOn:"button",buttonImage:"lib/external/jquery/css/images/calendar.png",buttonImageOnly:true,dateFormat:$(this).attr("data-dateformat"),timeFormat:$(this).attr("data-timeformat"),showHour:true,showMinute:true,showSecond:true,addSliderAccess:true,sliderAccessArgs:{touchonly:false}};if($(this).attr("data-years")){b.yearRange=$(this).attr("data-years")}$(this).datetimepicker(b)})}else{$(a+" .datetimepick").each(function(){$(this).val($(this).attr("data-stddatetime"))})}if(!window.Modernizr.inputtypes.time||!is_touch_device()){$(a+" .timepick").each(function(){if(!is_IE8()){$(this).attr("type","text")}$(this).timepicker({buttonImage:"lib/external/jquery/css/images/calendar.png",timeFormat:$(this).attr("data-timeformat"),addSliderAccess:true,sliderAccessArgs:{touchonly:false}})})}else{$(a+" .timepick").each(function(){$(this).val($(this).attr("data-stddatetime"))})}$(a+" .select2").each(function(){var c,b=$(this).outerWidth()+10+"px";if(parseInt(b,10)<20){c={dropdownAutoWidth:true}}else{c={width:b}}$(this).select2(c)});if($(a+" .report_autoexecute").length>0){$(".runreport").click()}$(a+" .ac_input").on("focusout",function(){if($(this).val()==""){var c,b=$(this).closest(".param_row").nextAll(".param_row");for(c=0;c<b.length;c++){if(!$(b[c]).hasClass("ac_id")){break}$(b[c]).find("input").val("")}}})}function select_opt_group(d){var c=$(d).parents(".optgroup"),a=c.find(".checkboxitem:visible").length,b=c.find(".checkboxitem:checked:visible").length,f;f=a>b&&$(d).is(":checked")?true:false;c.find(".checkboxitem:visible").prop("checked",f);set_param_cb_value(c.find(".checkboxitem")[0]);c.parents(".checkboxlist").find(".optgroupclick").click();c.find(".checkboxitem").first().trigger("change")}function set_optgroup_state(d,c){if(typeof(c)=="undefined"){$(d+" .param_input").find(".optgroup").each(function(){set_optgroup_state(d,$(this))})}if($(c).hasClass("checkboxlist")){c.find(".optgroup").each(function(){set_optgroup_state("",$(this))})}if($(c).hasClass("optgroup")){var a=c.find(".checkboxitem").filter(function(){return $(this).parent().css("display")!=="none"}).length,b=c.find(".checkboxitem:checked").filter(function(){return $(this).parent().css("display")!=="none"}).length;c.find(".optgroupcb").prop("indeterminate",false);if(a==b&&a!=0){c.find(".optgroupcb").prop("checked",true)}else{if(b==0){c.find(".optgroupcb").prop("checked",false)}else{c.find(".optgroupcb").prop("checked",false);c.find(".optgroupcb").prop("indeterminate",true)}}}}function set_param_cb_value(b){var c="",a="";$(b).parents(".checkboxlist").find(".checkboxitem:checked").each(function(){c+=a+$(this).val();a=","});$(b).parents(".checkboxlist").find(".cbinput").val(c);set_optgroup_state("",$(b).parents(".optgroup"))}function set_param_autocomplete(c,b,a){$("#"+c).autocomplete("apps/paramautoc.php",{extraParams:{sql:b,id:c},highlight:false,matchContains:true,max:a,scrollHeight:360,cacheLength:0,formatItem:function(d){return d[0]+(d[1]==undefined?"":d[1])},selectedRow:function(g){var e,d,f;for(d=2;d<g.length;d++){f=c.match(/\d+$/);e=c.substring(0,c.length-f.toString().length)+(parseInt(f,10)+d-1);$("#"+e).val(htmlspecialchars_decode(g[d]))}},formatResult:function(d){return htmlspecialchars_decode(d[0])}})}function input_change_handler(a){if(a.attr("data-last_value")==undefined){a.attr("data-last_value",a.val())}else{if(a.attr("data-last_value")!=a.val()){a.attr("data-last_value",a.val());a.trigger("change")}}}function init_connected_param(elem,param,affected,datatypes,params){var $te,input,data,cv,tobechanged;if(elem){elem="#"+elem+" "}if(1==0){$te=$(elem+'input[name="u'+param+'"]');if($te.closest(".checkboxlist").length>0){setInterval(function(){input_change_handler($te)},100)}}$(document).on("change",elem+"input.checkboxitem, "+elem+'input[name="u'+param+'"], '+elem+'select[name="u'+param+'"]',function(e){var i,tc,id_check;if($(this).hasClass("checkboxitem")){id_check=elem+"u"+param;if(this.id.substr(0,id_check.length)!=id_check){return}set_param_cb_value(this)}else{cv=$(this).attr("data-cv");if($(this).attr("type")!="radio"&&typeof cv!=="undefined"&&cv!==false){if(cv==$(this).val()){return}}}tobechanged=[];for(i=0;i<affected.length;i+=2){data=$(elem+"form").first().serializeObject();data.p_elem=elem;data.p_id=affected[i];data.p_query=affected[i+1];data.p_datatypes=datatypes;data.p_params=params;data.p_options="{}";input=$(elem+'[name="u'+data.p_id+'"]').first();if(input.first().is("select")||input.parent().hasClass("popuplist")){data.p_format="popup";if(input.hasClass("select2")){data.p_options='{"find":1}'}}else{if(input.parents().hasClass("checkboxlist")||input.first().next().find("input").attr("type")=="checkbox"){data.p_format="checkbox"}else{if(input.parent().hasClass("inline_param")){data.p_options='{"side_by_side":1}'}data.p_format="radio"}}tobechanged.push(elem+'[name="u'+affected[i]+'"]');$.ajax({url:"lib/connected_param.php",type:"get",data:data,async:false,success:function(data){eval(data)}})}$(this).attr("data-cv",$(this).val());for(tc=0;tc<tobechanged.length;tc++){$(tobechanged[tc]).first().change()}})}var hover_menu=null,mydbr_selected_cell=null,refreshCounter=null;$(document).ready(function(){if(is_touch_device()){$(".mydbr_popupframe").each(function(a){$(this).css("position","absolute")})}$(".mydbr_popupframe").each(function(a){$(this).draggable({handle:"th.border",stop:function(){popup_check_position("",$(this))}})});$(document).on("click",".search_arrow",function(){Tools(this)});$(document).on("click",".refresh_counter",function(){if(refreshCounter!==undefined&&!$(this).hasClass("no_toggle")){refreshCounter.toggle()}});$(document).on("click",".mydbr_popupframe th.border a, .dialog_close",function(){popupclose(this)});$(document).on("keyup",".mydbr_popupframe",function(a){if(a.keyCode&&a.keyCode===$.ui.keyCode.ESCAPE){popupclose($(this).find("th.border a"))}});$(document).on("touchend",".mydbr_popupframe",function(){move_popup_to_top($(this))});$(document).on("click",".mydbr_popupframe",function(){move_popup_to_top($(this))});$(document).on("click",".popupmenu .popuprow",function(){changeObjectVisibility(window.currentlyVisiblePopup,"none");window.currentlyVisiblePopup=false});$(document).on("click","area.new_window,a.new_window",function(){window.open(this.href);return false});$(document).on("change","td.autosubmit .jeditableform select",function(){$(this).closest("form").submit()});init_report_elements("");if($("#ajaxBusy").length==0){$("body").append('<div id="ajaxBusy"><p><img src="interface/images/loader.gif"></p></div>')}$(document).ajaxStart(function(){$("#ajaxBusy").show()}).ajaxStop(function(){$("#ajaxBusy").hide()});$("#param_input_toggle").click(function(){$(".param_input").first().slideToggle()});$("importform").submit(function(){import_start(this)});$(document).on("click",".inline_close",function(a){$(this).closest("tr.inline_report").remove()});$(document).on("click",".inline_newwin",function(a){window.open($(this).attr("data-url"));$(this).closest("tr.inline_report").remove()})});function refresh_counter_init(a){refreshCounter=new Countdown({seconds:a,onCounterEnd:function(){location.reload()},onUpdateStatus:function(b){$(".refresh_counter").text(b)}});refreshCounter.start()}function ismainw(){return $("div.reports div.group").length?1:0}function fav_handle(reportid,url,favid,ismain){var curr_url="report.php"+location.search;if(ismain!==undefined&&ismain){curr_url=""}$.ajax({url:"apps_v/favourite_v.php",type:"post",data:{favid:favid,reportid:reportid,url:url,curr_url:curr_url},success:function(set){if(set){var fav_reports,ret=eval("("+set+")");$("#favmenu").html(ret.menu);hovermenu_init("",ismainw());fav_reports=new Array();$(".is_fav").each(function(s){if(jQuery.inArray(parseInt($(this).attr("id").substr(1),10),fav_reports)<0){$(this).toggleClass("no_fav");$(this).toggleClass("is_fav")}})}}})}function dynamic_pdf_export_url(a){var c,b;if($(".mydbr_tabs").length){c=$(a).find("li.pdf a").attr("href");b=$.getQueryParameters(c);$(".mydbr_tabs").each(function(d){var e=$(this).attr("id");b["t_"+e]=$("#"+e).tabs("option","active")});c=decodeURIComponent($.param(b,true));$(a).find("li.pdf a").attr("href",c)}}function hovermenu_init(b,a){$(b+" .hovermenu_icon > li").hover(function(){if(hover_menu){hover_menu.find("ul").fadeOut("fast");hover_menu.find(".menutip").css("display","none");hover_menu=null}$(this).find("ul").fadeIn("fast");dynamic_pdf_export_url($(this).find("ul"));$(this).find(".menutip").fadeIn("fast")},function(){hover_menu=$(this);setTimeout("check_hovermenu_hover()",400)});$(".favourites .rmfav").each(function(){$(this).click(function(){var c=parse_num_attr($(this).children(":first-child").attr("href"));fav_handle(c.r,"",c.f,ismainw());return false})});$(".favadd span a").click(function(){fav_handle($(this).parent().attr("id").substring(8),"report.php"+location.search,0);return false})}function check_hovermenu_hover(){if(hover_menu){hover_menu.find("ul").fadeOut("fast");hover_menu.find(".menutip").fadeOut("fast")}}function editable_def_callback(value,settings){var cut=0,is_json=false;if(value.substr(0,9)=="dbr.html:"){cut=9}else{if(value.substr(0,9)=="dbr.json:"){cut=9;is_json=true}else{if(value.substr(0,13)=="dbr.purehtml:"){cut=13}}}if(cut>0){if(is_json){json=jQuery.parseJSON(value.substr(cut));eval(json[0]);$(this).text(json[1])}else{$(this).html(value.substr(cut))}}}function init_report_elements(e){$(e+" .accordion").each(function(){var options,options_str=$(this).attr("data-options"),acc_options={autoHeight:false,collapsible:true,heightStyle:"content"},multi={beforeActivate:function(event,ui){var currHeader,currContent,isPanelSelected;if(ui.newHeader[0]){currHeader=ui.newHeader;currContent=currHeader.next(".ui-accordion-content")}else{currHeader=ui.oldHeader;currContent=currHeader.next(".ui-accordion-content")}isPanelSelected=currHeader.attr("aria-selected")=="true";currHeader.toggleClass("ui-corner-all",isPanelSelected).toggleClass("accordion-header-active ui-state-active ui-corner-top",!isPanelSelected).attr("aria-selected",((!isPanelSelected).toString()));currHeader.children(".ui-icon").toggleClass("ui-icon-triangle-1-e",isPanelSelected).toggleClass("ui-icon-triangle-1-s",!isPanelSelected);currContent.toggleClass("accordion-content-active",!isPanelSelected);if(isPanelSelected){currContent.slideUp()}else{currContent.slideDown()}return false}};if(options_str!==undefined){options=jQuery.parseJSON(options_str);if(options.multiopen===true){jQuery.extend(options,multi)}jQuery.extend(acc_options,options)}$(this).accordion(acc_options)});$(e+" div.pager").mydbr_pager();if((!$.browser.msie)||($.browser.version>=8)){$(e+" .tTip").tipTip({defaultPosition:"top",maxWidth:"auto"})}if($(e+" .search").length>0){if($(e+" .search").css("display")=="none"){$(e+" table").hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")})}}if(typeof mydbr_loc=="undefined"){return}$(e+" table th.selectfilter,"+e+" table th.textfilter").closest("table").each(function(){$(this).columnfilter({all:mydbr_loc.MYDBR_AA_ALL,skip_row:["summary_row"]})});$(e+" div.gvchart").hover(function(){$(this).addClass("gvchartactive")},function(){$(this).removeClass("gvchartactive")});$(e+" table.tblr:not(.no_tooltip) td").hover(function(s){tt(this)});$(e+" table.scrollable").each(function(){$(this).scrollabletable({height:$(this).attr("data-scrollheight")})});$(e+" table.sortable").each(function(){var i,sort_values,ts,sort_param=new Array(),w=["zebra"];ts=$(this).attr("data-sort");if(ts!==undefined){sort_values=ts.split(",");for(i=0;i<sort_values.length;i+=2){sort_param.push([sort_values[i],sort_values[i+1]])}}if($(this).hasClass("sort_rmbr")){w.push("saveSort")}$(this).tablesorter({widgets:w,sortList:sort_param})});$(e+" table.sortable th.cell_header,"+e+" table.sortable .cell_ct").each(function(s){if(!$(this).hasClass("unsortable")){this.title=mydbr_loc.MYDBR_AA_MULTILEVEL_SORT}});if(!$.browser.msie||$.browser.version>=8){$(e+" table.stickyheader").each(function(){if($(this).closest(".mydbr_popupframe").length==0){$(this).stickyTableHeaders()}})}hovermenu_init(e,(location.pathname.slice(-9)=="index.php"));$(e+" .editable").each(function(i,e){var sql,type,url,options,editable_options,hash,inputtype,select,submit_b,cancel_b,no_edit,dataType,format,json_callback;sql=$(this).attr("data-url");no_edit=$(this).hasClass("no_edit");if(no_edit){$(this).removeClass("editable")}if(sql&&!no_edit){json_callback=0;format=$(this).attr("data-format");if(typeof format==typeof undefined||format==false){format=""}hash=$(this).attr("data-urlhash");type=$(this).attr("data-type");select=$(this).attr("data-select");selectquery=$(this).attr("data-selectquery");inputtype=$(this).attr("data-input");options=eval("("+$(this).attr("data-options")+")");dataType=(options.dataType==undefined)?"text":options.dataType;delete options.dataType;if(options.callback==undefined){options.callback=editable_def_callback;json_callback=1}options.callback_user=null;if(options.onblur==undefined){options.onblur="submit"}if((select!==undefined&&select!="")||(selectquery!=undefined&&selectquery!="")){if(select!==undefined&&select!=""){options.data=select}else{options.loadurl="lib/editable.php?"+selectquery}if(options.type==undefined){options.type=((inputtype==undefined)||inputtype=="")?"select":inputtype}options.callback_user=options.callback;options.callback=editable_select;json_callback=0}if(options.onblur!="submit"||options.type=="radiobutton"||options.type=="datetimepicker"||options.type=="datepicker"||options.type=="timepicker"){submit_b='<button type="submit">'+mydbr_loc.MYDBR_AA_OK+"</button>";cancel_b=mydbr_loc.MYDBR_AA_CANCEL;options.onblur=""}if(options.onblur!="submit"&&(options.type=="datepicker")){options.onblur=""}if(options.type==undefined&&$(this).hasClass("align_r")){options.type="textright"}if(!is_touch_device()&&options.type=="select"&&options.onblur=="submit"){$(this).addClass("autosubmit")}editable_options={submitdata:{mydbr_sql:sql,mydbr_type:type,mydbr_hash:hash,mydbr_format:format,mydbr_json_callback:json_callback},ajaxoptions:{dataType:dataType},placeholder:"",cssclass:"jeditableform",cancel:cancel_b,submit:submit_b};jQuery.extend(editable_options,options);url="lib/save.php";$(this).editable(url,editable_options);$(this).removeAttr("data-url");$(this).removeAttr("data-type");$(this).removeAttr("data-options");$(this).removeAttr("data-urlhash");$(this).removeAttr("data-select");$(this).removeAttr("data-query");$(this).removeAttr("data-input");$(this).removeAttr("data-colstyle")}});$(e+" div.dbrlist_menu").click(function(){$(this).children("ul").slideToggle("fast")});$(e+" .dbrlist li").each(function(s){$(this).click(function(){$(this).parent().children().removeClass("selected");$(this).addClass("selected")})});$(e+" .mydbr_tabs").each(function(s){$(this).tabs({fx:{opacity:"toggle",duration:"fast"},active:$(this).attr("data-selected"),load:function(event,ui){init_report_elements("#"+$(ui.panel).attr("id"))}})});$(e+" .gv_source_toggle").each(function(s){$(this).click(function(){gv_toggle_source(this)})});init_scale_image(e);$(e+" .mydbr_tab_wrapper").css("visibility","visible");$(e+" .accordion_wrapper").css("visibility","visible");$(e+" .mydbrselectlist").each(function(){$(this).change(function(){mydbr_selected_cell=this;window.location.href=$(this).val()})})}function export_disable(a){$(document).ready(function(){var c,d,b=a.split(",");for(c=0;c<b.length;c++){$(".hovermenu li."+b[c].toLowerCase()).remove()}d=$(".hovermenu");for(c=0;c<d.length;c++){if($(d[c]).children().length==0){$(d[c]).closest("ul.hovermenu_icon").remove()}}})}function copyIE(a){window.clipboardData.setData("Text",a);alert(mydbr_loc.MYDBR_AA_COPY_TO_CLIPBOARD_OK)}function urldecode(a){return decodeURIComponent(a.replace(/\+/g,"%20"))}function popupclose(c){if($(c).parents().length==0){c=this}$(c).parents(".mydbr_popupframe").hide();$("body").css("height","auto").css("width","auto");var b=null,a=null;$(".mydbr_popupframe:visible").each(function(d){var e=parseInt($(this).css("z-index"),10);if(!b||e>b){b=e;a=this}});if(a){$(a).focus()}}function drill_img(){var c,b,a;b="Link"+arguments[1]+"Menu";popuptable=$("#"+b)[0].children[0];c=0;for(c=2;c<arguments.length;c++){a=popuptable.rows[c-1].cells[0];$(a).html(urldecode(arguments[c]))}return !showPopup(b,arguments[0],true)}function move_popup_to_top(c){if(!c){return}var a,b=parseInt(c.css("z-index"),10);$(".mydbr_popupframe").each(function(d){if(this!=c.get(0)&&$(this).is(":visible")){b=Math.max(b,parseInt($(this).css("z-index"),10)+1)}});c.css("z-index",b);a=$(document.activeElement);if(c.has(a).length==0&&c!=a){c.focus()}}function popup_check_position(g,e,b){var n,d,m,c,j,i,f,l,o,p,a,h,k;if(typeof b=="undefined"){b=false}if(g==""){g=e.find(".popup_content")}p=g.css("overflow-y")?g.css("overflow-y"):"visible";a=g.css("overflow-x")?g.css("overflow-x"):"visible";g.css("overflow-y","initial");g.css("overflow-x","initial");g.css("height","auto");g.css("width","auto");if(is_touch_device()){e.css("position","absolute")}n=$(window).height()-80;d=$(window).width()-20;if(g.height()>n&&!is_touch_device()){g.css("height",n);if(p!="scroll"){e.width(e.width()+25)}g.css("overflow-y","scroll")}if(g.width()>d&&!is_touch_device()){f=e.width()-g.width();g.css("overflow-x","scroll");g.css("width",d);e.width(d+f);e.css("left",5)}if(g.height()>n&&is_touch_device()){$("body").css("height",($(window).scrollTop()+g.height()+100)+"px")}m=e.offset().top;if(e.css("position")!="absolute"){m-=$(window).scrollTop()}if(m<0){m=0;e.animate({top:m})}c=m+e.outerHeight();if(c>$(window).height()&&!is_touch_device()){if(b){if(m>$(window).height()){fh=e.find(".border").first().outerHeight()+2;e.animate({top:$(window).height()-fh})}}else{j=c-$(window).height()+10;m=m-j;if(is_touch_device()){m=$(window).scrollTop()+10}if(m<0){m=5}e.animate({top:m})}}c=m+e.outerHeight();i=e.offset().left-$(window).scrollLeft();l=0;if(is_touch_device()){if(e.width()+$(window).scrollLeft()>$(document).width()){l=1}}else{i=e.offset().left;if(e.width()+i>$(document).width()){l=e.width()+i-$(document).width()}}h=0;k=50;if(b){h=e.width()-k}if(i<(-1*h)||l>h){if(is_touch_device()){o=$(window).scrollLeft()+5;if(e.width()+o>$(document).width()){$("body").css("width",(e.width()+10)+"px");o=5}}else{if(l>0){l+=10}if(i<(-1*h)){i=-1*h;e.animate({left:i})}else{e.animate({left:e.offset().left-l+h})}}}if(is_touch_device()){$(e).find(".border > .close").css("margin-left","20px")}move_popup_to_top($(g).parents(".mydbr_popupframe"))}function embed_title(d){var e,b,c,a;e="";b=/(<div class="title">.*?<\/div>)|(<th colspan="2" class="paramTitle">.*?<\/th>)/i;c=d.match(b);if(c&&c.length>0){e=c[0];e=e.replace(/(<([^>]+)>)/gi,"");d=d.replace(b,"");if(d.substring(0,6).toLowerCase()=="<br>"){d=d.substring(6)}}a=new Object;a.title=e;a.data=d;return a}function embed_set_data(d,e,h,c){var g,a,i,f,b,j;g=$("#"+d).closest(".mydbr_popupframe");a=(e.search('class="param_input')>0);i=g.hasClass("mydbr_popupframe")&&(!new RegExp(/^<script.*<\/script>$/).test(e));if((i)||(a)){f=embed_title(e);h=f.title?f.title:h;e=f.data}if(!i&&a){d="popup";g=$("#"+d).closest(".mydbr_popupframe")}$("#"+d).html(e);if((i)||(a)){if(typeof c=="undefined"){c=""}if(i&&c!=""){g.attr("data-refreshurl",c)}g.find("th").first().find("span").html(h);g.fadeIn();popup_check_position($("#"+d),g);if(g.find("form.param_input").length==0||g.find("form.param_input").hasClass("in_report_param")){g.find(".border .newwin").show()}else{g.find(".border .newwin").hide()}g.find("form.param_input").submit(function(){b=$(this).serialize();var k=getUrlPath()+"?"+b.replace("&embedi="+d,"");if(d=="popup_parameter"){window.location.href=k;return false}g.find(".border .newwin").attr("onclick","window.open('"+k+"')");execute_popup_report(b);if(!i){popupclose(this)}return false})}init_report_params("#"+d);if((i)||(a)){popup_check_position($("#"+d),g)}init_report_elements("#"+d);j=e.match(/^<script[^>]*>([\s\S]*?)<\/script>$/ig);if(!$("#"+d).hasClass("no_scroll_to")&&$("#"+d).css("display")!="none"&&e!=""){if(!i&&!j&&!$("#"+d).visible(true)){$.scrollTo($("#"+d),800,{easing:"easeInOutCubic",onAfter:function(){$("#"+d).effect("highlight",500)}})}else{if(!i&&!j){$("#"+d).effect("highlight",500)}}}}function embed_element(h,o,l,m){var a,n,j,b,c,d,g,f,i,e,k;if(typeof l=="undefined"){l=""}if(typeof m!="undefined"&&m!=null&&h!="inline"){mydbr_selected_cell=m}n=false;if(h=="inline"){a=$(m).closest("tr");if(a.length==0){a=$(mydbr_selected_cell).closest("tr")}if(a.length>0){if(a.next().hasClass("inline_report")){a.next().remove();return}h=a.closest("table").attr("id")+"r_"+a.prevAll("tr").not(".inline_report").length;a.after('<tr class="inline_report"><td id="'+h+'" class="inline_report_cell" colspan="'+a.children().length+'"></td></tr>');n=true}}d=false;g="";f="new_popup";i=".content";e="popup";k=h;if(h.slice(-2)=="[]"){d=true;h=h.substr(0,h.length-2)}if(h.indexOf(".")>0){i="#"+h.substr(0,h.indexOf("."));h=h.substr(h.indexOf(".")+1);if(h.indexOf(".")>0){g=h.substr(h.indexOf(".")+1);h=h.substr(0,h.indexOf("."))}}dynamic_popup=((h.slice(0,e.length)==e)&&h!=e)||(k==f);if((d||dynamic_popup)&&!$("#"+h)[0]){c=1;while($("#"+h+c)[0]){c++}if(h==f){h=h+c}if(dynamic_popup){b='<table class="mydbr_popupframe"><tr><th class="border"><a class="close" href="javascript:void(0)"></a><a class="newwin" href="javascript:void(0)"></a><span></span></th></tr><tr><td><div class="popup_content" id="'+h+'"></div></td></tr></table>';$(".content").append($(b));$("#"+h).closest(".mydbr_popupframe").draggable({handle:"th.border",stop:function(){popup_check_position("",$(this),true)}})}else{if(!$(i)[0]){i=i.substr(1);alert("Missing target embed object '"+i+"'.\nCreate the object using command:\nselect 'dbr.embed_object', '"+i+"';");return}else{$(i).append($('<div id="'+h+'" class="'+g+'"></div>'))}}}$("#"+h).closest(".mydbr_popupframe").find(".border .newwin").attr("onclick","window.open('"+o+"');");$("#"+h).closest(".mydbr_popupframe").attr("tabIndex",-1).css("outline","0");if(!$("#"+h)[0]){alert("Missing target embed object '"+h+"'.\nCreate the object using command:\nselect 'dbr.embed_object', '"+h+"';");return}j=o;if(h!=="popup_parameter"){j+="&hdr=0"}$.ajax({url:j,type:"get",data:{embedi:h},success:function(p){embed_set_data(h,p,l,j+"&embedi="+h);if(n){$("#"+h).prepend('<div style="position: relative;"><button class="ui-button ui-state-default ui-corner-all ui-button-icon-only inline_newwin" data-url="'+o+'" role="button" aria-disabled="false" style="position: absolute;right: 24px;top:-24px;"><span class="ui-button-icon-primary ui-icon ui-icon-newwin"></span><span class="ui-button-text">close</span></button><button class="ui-button ui-state-default ui-corner-all ui-button-icon-only inline_close" role="button" aria-disabled="false" style="position: absolute;right: 0px;top:-24px;"><span class="ui-button-icon-primary ui-icon ui-icon-close"></span><span class="ui-button-text">close</span></button></div>')}}})}function execute_popup_report(b){var a,c;if(b.substr(0,7)!="http://"&&b.substr(0,8)!="https://"){a=getUrlPath()+"?"+b}else{a=b}c=gup(a,"embedi");if(!c){c="popup"}$.ajax({url:a,type:"get",success:function(d){if(d){embed_set_data(c,d,"",a)}else{$(".mydbr_popupframe").hide();$("#"+c).html("")}}})}function drill_set(b,f){var d,e,g,c,a;mydbr_selected_cell=f;c=$("#"+b)[0].children[0];g=f.lastChild?f.lastChild:f.next();for(e=0;e<g.children.length;e++){d=g.children[e].firstChild.cloneNode(true);if(d.href.indexOf("embed_element")>0){d.href=d.href.replace(/%/g,"%25")}a=c.rows[e+1].cells[0];a.replaceChild(d,a.firstChild)}}function CopyTable(c,b){var e="",g=false,a,f,d=document.getElementById(c);for(a=0;a<d.rows.length;a++){if($(d.rows[a]).parent().hasClass("tableFloatingHeader")){continue}if(a!=0&&e!=""){e=e+"\n";if(g){e=e+"\t";g=false}}for(f=0;f<d.rows[a].cells.length;f++){if(d.rows[a].cells[f].className!="invisible"&&!$(d.rows[a].cells[f]).hasClass("drill")&&d.rows[a].cells[f].className!="dbrResultSetTitle"){if(d.rows[a].cells[f].className=="cell_ct_top"){if(d.rows[a].cells[f].rowSpan==2){g=true}}if(f!=0){e=e+"\t"}if($(d.rows[a].cells[f]).hasClass("summary")){e=e+'"'+$(d.rows[a].cells[f]).text()+'"'}else{e=e+$(d.rows[a].cells[f]).text()}}}}if(b===undefined){return e}else{copyIE(e)}}function HideDL(a){$("#iedl_"+a).slideDown()}function NetwExport(a){$("#iedl_"+a).slideDown();$("#iedl_"+tableID).effect("shake",{distance:5})}function NetwSrc(c){var b=document.getElementById("tool_"+id),a=document.getElementById("tab_"+id);if(a.style.display=="none"){b.src="images/tab_d.gif";a.style.display=""}else{b.src="images/tab_r.gif";a.style.display="none"}}function gv_toggle_source(a){$(a).toggleClass("arrow_right");$(a).toggleClass("arrow_down");$(a).parents(".gvchart").find(".gvsource").toggle()}function Tools(b){var a=$(b).siblings(".search_div");if($(b).hasClass("arrow_right")){$(a).removeClass("search");$(a).css("display","none");$(b).removeClass("arrow_right");$(b).addClass("arrow_down");a.show("slide",{direction:"up",complete:function(){if(!$(b).hasClass("no_focus")){a.find(".findit").focus()}}})}else{$(b).removeClass("arrow_down");$(b).addClass("arrow_right");a.slideUp();$(a).addClass("search")}}function getHdrCell(b,e,f){var d=0,a=0;while(e.cells.length>d&&(b+e.cells[d].colSpan+a)<f+1){a+=e.cells[d].colSpan;d++}if(e.cells.length>d){return $(e.cells[d]).text()}else{return""}}function tt(g){if(g.title!=""||$(g).hasClass("drill")){return}var d=$(g).closest("tr"),c=$(g).closest("table"),f="",b,e,a;a=$(c).find("thead:not(.tableFloatingHeader) tr:not(.selectfilter,.textfilter)");if(a.length==1){return}nbrOfHdr=a[0].cells[0].colSpan;e=a.length;for(b=0;b<nbrOfHdr;b++){f+=$(d[0].cells[b]).text()+" "}f+=" / ";if(e==1){f+=$(c.rows[1].cells[g.cellIndex]).text()}else{f+=$(a[0].cells[1]).text()+" ";if(e==3){f+=getHdrCell(nbrOfHdr,a[1],g.cellIndex);if(e>1){f+=" / "+getHdrCell(1,a[2],g.cellIndex+1)}}else{if(e==2){f+=getHdrCell(1,a[1],g.cellIndex+1)}}}g.title=f}function autosum_int(d,c,a,b){if(typeof d!="object"){d=this}if(typeof c!="number"){c=d.cellIndex+1}if(typeof a!="string"){a=""}if(typeof b!="string"){b=""}ct_total(d,c-1,0,a,b);col_sum(d,c-1,0,a,b)}function autosum_float(e,d,a,b,c){if(typeof e!="object"){e=this}if(typeof d!="number"){d=e.cellIndex+1}if(typeof a!="number"){a=0}if(typeof b!="string"){b=""}if(typeof c!="string"){c=""}ct_total(e,d-1,a,b,c);col_sum(e,d-1,a,b,c)}function ct_total(f,a,d,g,i){var c,h,e,b;e=$(f).attr("data-ct_col");b=$(f).parent().find("."+e);if(b.length==0||e=="undefined"){return}c=b.attr("data-ct_oper");total=c=="sum"?0:null;$(f).parent().find('[data-ct_col="'+e+'"]').each(function(j,k){h=cell_value_get($(this),d,null,g,i);if(total==null||h==null){total=(h==null)?total:h}else{if(c=="sum"){total+=h}else{if(c=="min"){total=(h<total)?h:total}else{if(c=="max"){total=(h>total)?h:total}}}}});cell_value_set(b,total,d,g,i);col_sum(f,b.index(),d,g,i)}function cell_value_get(d,a,b,c){if(typeof a!="number"){a=0}if(typeof b!="string"){b=""}if(typeof c!="string"){c=""}val=$(d).text();val=val.replace(mydbr_sorting.separator.thousand,"");val=val.replace(mydbr_sorting.separator.decimal,".");if(typeof val=="string"){val=val.replace(/[^\d\.-]/g,"")}if(val==""){return null}return val?parseFloat(val):0}function cell_value_set(d,e,a,b,c){if(typeof a!="number"){a=0}if(typeof b!="string"){b=""}if(typeof c!="string"){c=""}$(d).html(b+number_format(e,a,mydbr_sorting.separator.decimal,mydbr_sorting.separator.thousand)+c)}function col_value_text(b,a,d){var c=b.parentNode;if(typeof a!="number"){a=b.cellIndex+1}if(arguments.length>2){$(c.cells[a-1]).html(d)}return $(c.cells[a-1]).html()}function col_value_get(e,b,a,c,d){var f;if(typeof b!="number"){b=e.cellIndex+1}f=$(e).closest("tr").children().eq(b-1);if(f.length==0){return null}return cell_value_get(f,a,c,d)}function col_value_set(e,b,a,g,c,d){var f=$(e).closest("tr").children().eq(b-1);if(f.length==0){return null}cell_value_set(f,g,a,c,d)}function col_sum(f,a,c,h,l){var m,j,b,g=[],k,d,e;tbody=f.parentNode.parentNode;if(typeof a!="number"){a=f.cellIndex}if(typeof c!="number"){c=0}if(typeof h!="string"){h=""}if(typeof l!="string"){l=""}j=0;for(m=0;m<tbody.rows.length;m++){if($(tbody.rows[m]).hasClass("summary_row")){k=$(tbody.rows[m].cells[a]);if(k.hasClass("summary_level0")){d=0}else{if(k.hasClass("summary_level1")){d=1}else{if(k.hasClass("summary_level2")){d=2}else{if(k.hasClass("summary_level3")){d=3}else{if(k.hasClass("summary_level4")){d=4}}}}}for(e=0;e<=d;e++){if(typeof g[e]=="undefined"){g[e]=j}else{g[e]+=j}}k.html(mydbr_sorting.sum_prefix+" "+h+number_format(g[d],c,mydbr_sorting.separator.decimal,mydbr_sorting.separator.thousand)+l);if(d==0){return j[d];break}else{for(e=d;e<g.length;e++){g[e]=0}j=0}}else{if($(tbody.rows[m]).hasClass("no_mydbr_count")||$(tbody.rows[m].cells[a]).hasClass("no_mydbr_count")){continue}b=$(tbody.rows[m].cells[a]).html();b=b.replace(mydbr_sorting.separator.thousand,"");b=b.replace(mydbr_sorting.separator.decimal,".");if(typeof b=="string"){b=b.replace(/[^\d\.-]/g,"")}b=parseFloat(b);if(!isNaN(b)){j+=parseFloat(b)}}}return j}function editable_select(){var select,callback,editable_id,cell,i;switch(arguments[1].type){case"radiobutton":default:if(arguments[1].data!==undefined){select=eval("("+arguments[1].data+")");if(select.length>0&&typeof select[0]==="object"){for(i=0;i<select.length;i++){if(select[i]["i"]==arguments[0]){$(this).html(select[i]["v"]);break}}}else{$(this).html(select[arguments[0]])}}editable_id=arguments[0];cell=this;if(arguments[1].loadurl!==undefined){$.ajax({url:arguments[1].loadurl,async:false,success:function(result){select=eval("("+result+")");$(cell).html(select[editable_id])}})}}if(arguments[1].callback_user){callback=arguments[1].callback_user;callback.apply(this,[arguments[0],arguments[1]])}}function import_start(a){if($("#ul_form_"+a+' label [name="mydbrimport"]')[0].value==""){alert(mydbr_loc.MYDBR_IMPORT_SELECT);return false}else{$("#ul_form_"+a).hide();$("#ul_process_"+a).show();return true}}function import_stop(d,b,c){var a="";$("#im_nok_"+d).hide();$("#im_ok_"+d).hide();$("#im_msg_"+d).hide();$("#ul_process_"+d).hide();if(c!=""){$("#im_msg_"+d).html(c);$("#im_msg_"+d).show()}else{if(b){$("#im_ok_"+d).show()}else{$("#im_nok_"+d).show()}}$("#ul_form_"+d).html(a+"<label>"+mydbr_loc.MYDBR_IMPORT_FILE+' <input name="mydbrimport" type="file" size="30"><br></label><label><input type="submit" value="'+mydbr_loc.MYDBR_IMPORT_IMPORT+'"></label>');$("#ul_form_"+d).show();$.ajax({url:"lib/import_result.php",type:"get",data:{id:d},success:function(e){$("#im_"+d+" > .result").show().html(e);$("#im_"+d+" > .content").hide()}});return true}function set_scrollable_position(a){a.closest(".scrolling_area").scrollTop($("tr.scrollable_top",a).offset().top-$("tbody tr:first",a).offset().top)}$.tablesorter.addWidget({id:"saveSort",format:function(a){var b,c=$(a);if(c.hasClass("sort_rmbr")){if(a.config.debug){b=new Date()}if(c.hasClass("has_sort_rmbr")&&a.config.hasInitialized){$.ajax({url:"lib/sort_remember.php",type:"post",data:{table_id:c.attr("id"),report:getURLParameter("r"),sortlist:JSON.stringify(a.config.sortList)}})}else{c.addClass("has_sort_rmbr")}if(a.config.debug){$.tablesorter.benchmark("Applying saveSort widget",b)}}}});function showPopup(b,c,a){var e,d,f;if(c){hideCurrentPopup(c);c.cancelBubble=true;f=get_event_coord(c,-5,-5,true);e=c.target?c.target:c.srcElement;changeObjectVisibility(b,"block");d=$("#"+b).parentRelative();f.x-=d.left;f.y-=d.top;if(a){moveObject(b,f)}window.currentlyVisiblePopup=b;return true}else{return false}}function elementOrParentIsFixed(c){var b=$(c),a=b.add(b.parents()),d=false;a.each(function(){if($(this).css("position")==="fixed"){d=true;return false}});return d}function get_event_coord(c,b,d,a){var e=new Object();if(c.pageY&&!$.browser.msie){e.x=c.pageX+b;e.y=c.pageY+d;if(a&&elementOrParentIsFixed(c.currentTarget)){e.x-=document.body.scrollLeft;e.y-=document.body.scrollTop}}else{e.x=c.clientX+document.documentElement.scrollLeft+b;e.y=c.clientY+document.documentElement.scrollTop+d;if(a&&elementOrParentIsFixed(c.currentTarget)){e.x-=document.documentElement.scrollLeft;e.y-=document.documentElement.scrollTop}}return e}function hideCurrentPopup(g){var f,c,d,a,b,i;d=window.event||g;if(d.button==2){return}if(window.currentlyVisiblePopup){coord=get_event_coord(d,0,0,false);a=$("#"+window.currentlyVisiblePopup).width();b=$("#"+window.currentlyVisiblePopup).height();i=$("#"+window.currentlyVisiblePopup).offset();f=coord.x<i.left||(coord.x>(i.left+a));c=coord.y<i.top||(coord.y>(i.top+b));if((f)||(c)){changeObjectVisibility(window.currentlyVisiblePopup,"none");window.currentlyVisiblePopup=false}}}window.onload=initializeHacks;document.onclick=hideCurrentPopup;function initializeHacks(){if((navigator.appVersion.indexOf("MSIE 5")!=-1)&&(navigator.platform.indexOf("Mac")!=-1)&&getStyleObject("blankDiv")){window.onresize=explorerMacResizeFix}resizeBlankDiv();createFakeEventObj()}function createFakeEventObj(){if(!window.event){window.event=false}}function resizeBlankDiv(){if((navigator.appVersion.indexOf("MSIE 5")!=-1)&&(navigator.platform.indexOf("Mac")!=-1)&&getStyleObject("blankDiv")){getStyleObject("blankDiv").width=document.body.clientWidth-20;getStyleObject("blankDiv").height=document.body.clientHeight-20}}function explorerMacResizeFix(){location.reload(false)}function getStyleObject(a){if(document.getElementById&&document.getElementById(a)){return document.getElementById(a).style}else{if(document.all&&document.all(a)){return document.all(a).style}else{if(document.layers&&document.layers[a]){return document.layers[a]}else{return false}}}}function changeObjectVisibility(a,c){var b=getStyleObject(a);if(b){b.display=c;return true}else{return false}}function moveObject(b,h){var c,d=getStyleObject(b),a,g=get_x_size(),f,e;a=document.getElementById(b).offsetWidth-10;f=get_x_scroll();if((h.x+a)>g){e=g-a-10+f;h.x=(e<h.x)?e:h.x}if(d){d.left=h.x+"px";d.top=(h.y-5)+"px";c=$("#"+b).parentRelative();if((c.left!=0||c.top!=0)&&($("#"+b).offset().left+a>g)){to_left=$("#"+b).offset().left+a-g;h.x-=to_left+10+f;d.left=h.x+"px"}return true}else{return false}}function get_x_size(){var a=0;if(document.documentElement&&document.documentElement.clientWidth){a=document.documentElement.clientWidth}else{if(document.body&&document.body.clientWidth){a=document.body.clientWidth}else{if(window.innerWidth){a=window.innerWidth-18}}}return a}function get_x_scroll(){var a;if(window.pageXOffset){a=window.pageXOffset}else{if(window.event){a=document.documentElement.scrollLeft+document.body.scrollLeft}else{a=window.scrollX}}return a}function onMenu(a,b){b.style.cursor="pointer";document.getElementById(a).style.backgroundColor="#B0FE86"}function offMenu(a){document.getElementById(a).style.color="#000000";document.getElementById(a).style.backgroundColor="#FFFFFF"}(function(a){a.mydbr_pager=function(c,e){var l={},f=this,b=a(c),u=b.find(".pager_first_d"),r=b.find(".pager_prev_d"),m=b.find('input[name="page"]'),d=b.find(".max"),t=b.find(".pager_next"),q=b.find(".pager_last"),j=b.find('input[name="length"]'),s=b.find('input[name="start"]'),n=b.find('input[name="end"]'),g=function(){var E=b.closest("table"),D=parseInt(m.val(),10),A=parseInt(s.val(),10),x=parseInt(n.val(),10),z=parseInt(j.val(),10),C=((D-1)*z)+1,B=(D*z),v,y;y=E.find("TBODY").children().length-E.find(".last_row").length;A=isNaN(A)?0:A;x=isNaN(x)?0:x;if(B>y&&y>0){B=y}var w=new Date().getTime();for(v=A;v<=x;v+=1){E.find("tbody tr").eq(v-1).hide()}for(v=C;v<=B;v+=1){E.find("tbody tr").eq(v-1).show()}a('.pager_row input[name="page"]',E).val(D);a('.pager_row input[name="start"]',E).val(C);a('.pager_row input[name="end"]',E).val(B);if(parseInt(m.val(),10)<parseInt(d.text(),10)){a(".pager_row .pager_next",E).removeClass("pager_next_d").removeAttr("disabled");a(".pager_row .pager_last",E).removeClass("pager_last_d").removeAttr("disabled")}else{a(".pager_row .pager_next",E).addClass("pager_next_d").attr("disabled","disabled");a(".pager_row .pager_last",E).addClass("pager_last_d").attr("disabled","disabled")}if(parseInt(m.val(),10)>1){a(".pager_row .pager_prev",E).removeClass("pager_prev_d").removeAttr("disabled");a(".pager_row .pager_first",E).removeClass("pager_first_d").removeAttr("disabled")}else{a(".pager_row .pager_prev",E).addClass("pager_prev_d").attr("disabled","disabled");a(".pager_row .pager_first",E).addClass("pager_first_d").attr("disabled","disabled")}},i=function(){m.val(1);g()},o=function(){m.val(parseInt(m.val(),10)-1);g()},p=function(){m.val(parseInt(m.val(),10)+1);g()},k=function(){m.val(parseInt(d.text(),10));g()},h=function(){var v=parseInt(m.val(),10);if(isNaN(v)||v<1){m.val(1)}else{if(v>parseInt(d.text(),10)){m.val(d.text())}}g()};f.settings={};f.init=function(){f.settings=a.extend({},l,e);var w=b.closest("table"),x=j.val(),v;m.val(1);v=w.find("TBODY").children().length-w.find(".last_row").length;d.text(v>0?Math.ceil(v/x):1);u.on("click",function(){i()});r.on("click",function(){o()});t.on("click",function(){p()});q.on("click",function(){k()});m.on("change",function(){h()});g()};f.init()};a.fn.mydbr_pager=function(b){return this.each(function(){if(undefined===a(this).data("mydbr_pager")){var c=new a.mydbr_pager(this,b);a(this).data("mydbr_pager",c)}})}}(jQuery));